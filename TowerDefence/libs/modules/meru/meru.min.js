var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),meru;!function(t){var e=function(){function e(){this._isRunning=!1,this._timeLine=new TimelineMax({onComplete:this.onComplete.bind(this)}),this._animationInfoArr=[]}return Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),e.prototype.to=function(t,e,n){return this.mergeEase(e,n),this._animationInfoArr.push({duration:t/1e3,props:e}),this},e.prototype.mergeEase=function(t,e){e?t.ease=e:t.ease=Linear.easeNone},e.prototype.toProp=function(t,e){void 0===e&&(e="by");var n={};for(var r in t){var o=t[r];"by"==e||"x"==r||"y"==r?n[r]=o>0?"+="+o:"-="+Math.abs(o):n[r]=""+o}return n},e.prototype.fromProp=function(t,e,n){void 0===n&&(n="by");var r={};for(var o in e)r[o]="+=0";return r},e.prototype.set=function(t){return this._animationInfoArr.push({duration:0,props:t,type:"set"}),this},e.prototype.onComplete=function(){e.removeAnimation(this.target,this)},e.prototype.remove=function(){return this._animationInfoArr.push({duration:0,props:[],type:"remove"}),this},e.prototype.zoom=function(t,e,n,r){is.fun(n)?(r=n,n=0):is.falsy(n)&&(n=0);var o=(t-n)/2;return this.by(o,{scaleX:e,scaleY:e},r),n>0&&this.delay(n),this.by(o,{scaleX:-e,scaleY:-e},r),this},Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),e.prototype.run=function(t,n){var r=this;void 0===t&&(t=this._target),e.addAnimation(t,this),n&&this._timeLine.repeat(-1);for(var o=0;o<this._animationInfoArr.length;o++){var i=this._animationInfoArr[o];if("delay"==i.type)this._timeLine.to(t,i.duration,{});else if("call"==i.type){var a=i.props.sel,s=i.props.context;a&&this._timeLine.call(a.bind(s))}else"set"==i.type?this._timeLine.set(t,i.props):"by"==i.type?this._timeLine.fromTo(t,i.duration,this.fromProp(t,i.props),this.toProp(i.props)):"blueprint"==i.type?this._timeLine.fromTo(t,i.duration,this.fromProp(t,i.props,"blueprint"),this.toProp(i.props,"blueprint")):"remove"==i.type?this._timeLine.call(function(){t&&t.parent&&t.parent.removeChild(t)}):this._timeLine.to(t,i.duration,i.props)}return n||this._timeLine.call(function(){e.removeAnimation(t,r)}),this._isRunning=!0,this},e.addAnimation=function(t,e){t.$__animId__||(t.$__animId__=this._animatoinId++),this._animationMap.hasOwnProperty(t.$__animId__)||(this._animationMap[t.$__animId__]=[]),this._animationMap[t.$__animId__].push(e)},e.removeAnimation=function(t,e){if(t&&t.$__animId__){var n=this._animationMap[t.$__animId__];if(n){var r=n.indexOf(e);r>-1&&(e.destory(),n.splice(r,1)),0==n.length&&delete this._animationMap[t.$__animId__]}}},e.removeAnimationByTarget=function(t){if(t&&t.$__animId__){var e=this._animationMap[t.$__animId__];if(e)for(;e.length;)e.shift().destory();delete this._animationMap[t.$__animId__]}},e.prototype.delay=function(t){return this._animationInfoArr.push({duration:t/1e3,props:{},type:"delay"}),this},e.prototype.call=function(t,e){return this._animationInfoArr.push({duration:0,props:{sel:t,context:e},type:"call"}),this},e.prototype.score=function(t,e,n,r){return null},e.prototype.shake=function(t,e,n,r){return null},e.prototype.by=function(t,e,n){return this.mergeEase(e,n),this._animationInfoArr.push({duration:t/1e3,props:e,type:"by"}),this},e.prototype.blueprint=function(e,n,r){void 0===n&&(n=1),void 0===r&&(r={});var o=t.Config.get(t.getSetting().AnimationBlueprint),i=t.object.getValue(o,e,[]);if(is.array(i)&&i.length>0)for(var a=0,s=0,u=0;u<i.length;u++){var c=i[u];if(c.hasOwnProperty("delay"))this.delay(1e3*c.delay*n);else{var h=t.object.deepClone(c);for(var p in h)if(is.number(r)?"alpha"!=p&&(h[p]*=r):r.hasOwnProperty(p)&&(h[p]*=r[p]),"x"==p){var l=h[p];h[p]-=a,a=l}else if("y"==p){var l=h[p];h[p]-=s,s=l}var f=1e3*h.duration*n;this._animationInfoArr.push({duration:f/1e3,props:h,type:"blueprint"})}}return this},e.prototype.blink=function(t,e,n){for(var r=t/e,o=!0,i=0;e>i;i++)this.delay(r),this.set({visible:o}),o=!o;return this},e.prototype.fadeInOut=function(t,e){return this.to(t/2,{alpha:0},e),this.to(t/2,{alpha:1},e),this},e.prototype.destory=function(){this._timeLine.kill(),this._timeLine=null,this._target=null},e.prototype.stop=function(){this._timeLine.totalProgress(1),e.removeAnimation(this.target,this)},e.prototype.pause=function(){this._timeLine.pause()},e.prototype.setTarget=function(t){return this._target=t,this},e.prototype.resume=function(){this._timeLine.resume()},e.stopAnimationByTarget=function(t){if(t&&t.$__animId__){var e=this._animationMap[t.$__animId__];if(e&&e.length>0)for(;e.length;)e.shift().stop();delete this._animationMap[t.$__animId__]}},e.by=function(t,n,r){return(new e).by(t,n,r)},e.blueprint=function(t,n,r){return(new e).blueprint(t,n,r)},e.fadeInOut=function(t,n){return(new e).fadeInOut(t,n)},e.set=function(t){return(new e).set(t)},e.setTarget=function(t){return(new e).setTarget(t)},e.zoom=function(t,n,r,o){return(new e).zoom(t,n,r,o)},e.delay=function(t){return(new e).delay(t)},e.call=function(t,n){return void 0===n&&(n=null),(new e).call(t,n)},e.to=function(t,n,r){return(new e).to(t,n,r)},e._animationMap={},e._animatoinId=1,e}();t.Animation=e,__reflect(e.prototype,"meru.Animation",["meru.IAnimation"])}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){}return Object.defineProperty(t.prototype,"component",{get:function(){return this._component},set:function(t){this._component=t},enumerable:!0,configurable:!0}),t.prototype.show=function(t){t&&t()},t.prototype.close=function(t){t&&t()},t}();t.NoneAnimation=e,__reflect(e.prototype,"meru.NoneAnimation",["meru.IUIAnimation"]);var n=function(){function e(){}return Object.defineProperty(e.prototype,"component",{get:function(){return this._component},set:function(t){this._component=t},enumerable:!0,configurable:!0}),e.prototype.moveBy=function(e,n,r){t.Animation.removeAnimationByTarget(e),t.Animation.by(200,{x:640}).call(function(){n&&n()},r).run(e)},e.prototype.show=function(t){var e=this._component.getAnimationDisplay();e.x=-640,this.moveBy(e,t,Back.easeOut)},e.prototype.close=function(t){var e=this._component.getAnimationDisplay();e.x=0,this.moveBy(e,t,Back.easeIn)},e}();t.PanelAnimation=n,__reflect(n.prototype,"meru.PanelAnimation",["meru.IUIAnimation"]);var r=function(){function t(){}return Object.defineProperty(t.prototype,"component",{get:function(){return this._component},set:function(t){this._component=t},enumerable:!0,configurable:!0}),t.prototype.runAnimation=function(t,e,n){var r=this._component.getAnimationDisplay("box"),o=this._component.getAnimationDisplay("mask"),i=[];if(r){var a=e.call(this,r);a&&i.push(a)}if(o){var s=n.call(this,o);s&&i.push(s)}if(0==i.length)t&&t();else for(var u=0;u<i.length;u++)0==u&&i[u].call(t),i[u].isRunning||i[u].run()},t.prototype.show=function(t){this.runAnimation(t,this.getShowBoxAnmation,this.getShowMaskAnimation)},t.prototype.close=function(t){this.runAnimation(t,this.getCloseBoxAnimation,this.getCloseMaskAnimation)},t.prototype.getShowBoxAnmation=function(t){return null},t.prototype.getShowMaskAnimation=function(t){return null},t.prototype.getCloseBoxAnimation=function(t){return null},t.prototype.getCloseMaskAnimation=function(t){return null},t}();t.BaseBoxAnimation=r,__reflect(r.prototype,"meru.BaseBoxAnimation",["meru.IUIAnimation"]);var o=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.getShowBoxAnmation=function(e){return e.scaleX=e.scaleY=0,e.alpha=0,t.Animation.removeAnimationByTarget(e),t.Animation.to(150,{alpha:1,scaleX:1,scaleY:1}).run(e)},n.prototype.getShowMaskAnimation=function(e){var n=e.alpha;return e.alpha=0,t.Animation.to(150,{alpha:n}).run(e)},n}(r);t.BoxAnimation=o,__reflect(o.prototype,"meru.BoxAnimation")}(meru||(meru={}));var meru;!function(t){var e=function(){function e(t){this._cacheMap={},this._instMap={},this._propertyName=t}return Object.defineProperty(e.prototype,"propertyName",{get:function(){return this._propertyName},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._cacheMap.hasOwnProperty(t)&&this._cacheMap[t].length>0},e.prototype.getVal=function(t){var e=t.getValue(this._propertyName);return is.truthy(e)?e:"unknown"},e.prototype.onAdd=function(t){var e=this.getVal(t);is.truthy(e)&&(this._cacheMap.hasOwnProperty(e)||(this._cacheMap[e]=[]),this._instMap[t.hashCode]=e,-1==this._cacheMap[e].indexOf(t)&&this._cacheMap[e].push(t))},e.prototype.onDelete=function(e){var n=this.getVal(e);if(delete this._instMap[e.hashCode],this._cacheMap.hasOwnProperty(n)){var r=this._cacheMap[n];t.array.remove(r,e)}},e.prototype.update=function(e){if(this._instMap.hasOwnProperty(e.hashCode)){var n=this._instMap[e.hashCode];this._cacheMap.hasOwnProperty(n)&&t.array.remove(this._cacheMap[n],e),delete this._instMap[e.hashCode]}var n=this.getVal(e);is.truthy(n)&&(this._instMap[e.hashCode]=n,this._cacheMap.hasOwnProperty(n)||(this._cacheMap[n]=[]),-1==this._cacheMap[n].indexOf(e)&&this._cacheMap[n].push(e))},e.prototype.getNewModel=function(t,e){return null},e.prototype.getModel=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t==this._propertyName){for(var r=[],o=0;o<e.length;o++)this._cacheMap.hasOwnProperty(e[o])&&(r=r.concat(this._cacheMap[e[o]]));return r}return null},e}();t.DataStore=e,__reflect(e.prototype,"meru.DataStore",["meru.IDataStore"])}(meru||(meru={}));var meru;!function(t){var e;!function(t){var e=function(){function t(){}return t.formatAliasKey=function(t){var e=/([a-zA-Z_]+)\s*(as)\s*([a-zA-Z_]+)/gi,n={};return e.test(t)?(n.proxyKey=RegExp.$1,n.configKey=RegExp.$3):n.proxyKey=n.configKey=t,n},t}();t.DataUtils=e,__reflect(e.prototype,"meru.data.DataUtils")}(e=t.data||(t.data={}))}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){}return t.ERROR_DATA=1e5,t.TIME_OUT=100001,t.ERROR_REQUEST=100002,t}();t.ProxyErrorCode=e,__reflect(e.prototype,"meru.ProxyErrorCode");var n=function(n){function r(t){void 0===t&&(t={});var e=n.call(this)||this;return e._isTimeout=!1,e._timeoutId=null,e._method=egret.HttpMethod.GET,e._listeners=[],e._customParams={},e._params=e.formatParams(t),e._requestUrl=r.request_url,e}return __extends(r,n),r.prototype.formatParams=function(t){if(t&&!t.hasOwnProperty("do")&&t.hasOwnProperty("mod")){var e=t.mod;if(e.indexOf(".")>-1){var n=e.split(".");t.mod=n[0],t["do"]=n[1]}}return t},Object.defineProperty(r.prototype,"requestUrl",{get:function(){return this._requestUrl},set:function(t){this._requestUrl=t},enumerable:!0,configurable:!0}),r.prototype.paramsToQueryString=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0;r<t.length;r++){var o=t[r];for(var i in o)n.push(i+"="+o[i])}return n.join("&")},Object.defineProperty(r.prototype,"method",{get:function(){return this._method},set:function(t){this._method=t},enumerable:!0,configurable:!0}),r.prototype.load=function(){var n=this,o=-1==this._requestUrl.indexOf("?")?this._requestUrl+"?":this._requestUrl;"?"!=o[o.length-1]&&"&"!=o[o.length-1]&&(o+="&");var i=t.pullObject(t.ProxyAction.BEGIN_LOAD,this);if(this._status=t.ProxyStatus.REQUEST,t.postNotification(t.ProxyAction.REQUEST,this),i===this||i===!0){this._status=t.ProxyStatus.WAIT,t.postNotification(t.ProxyAction.WAIT,this);var a;a=t.localStorage.isSetPrefix()?t.localStorage.getItem("hashKey"):egret.localStorage.getItem("hashKey"),r.hashKey&&(a=r.hashKey);var s=this.getParamString(),u=s+t.pullObject("scode","xsanguox888~1f2a3"),c=new t.md5;this.addParam("s",c.hex_md5(u));var h=new egret.HttpRequest,p={h:a};if(h.responseType=egret.HttpResponseType.TEXT,h.addEventListener(egret.Event.COMPLETE,this.onComplete,this),h.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),this._timeoutId=egret.setTimeout(function(){h.removeEventListener(egret.IOErrorEvent.IO_ERROR,n.onError,n),h.removeEventListener(egret.Event.COMPLETE,n.onComplete,n),n._errorCode=e.TIME_OUT,n._errorMessage="请求超时",n._isTimeout=!0,t.postNotification(t.ProxyAction.TIMEOUT,n),n.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.TIME_OUT,n)),n.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.ERROR,n)),t.postNotification(t.ProxyAction.REQUEST_ERROR,n)},this,r._timeout),this._method==egret.HttpMethod.GET){p.data=s;var l=this.paramsToQueryString(p,this._customParams,r._globalParams);o+=l,h.open(o,egret.HttpMethod.GET),h.send()}else{var l=this.paramsToQueryString(p,this._customParams,r._globalParams);o+=l,h.open(o,egret.HttpMethod.POST),h.send(s)}}},Object.defineProperty(r.prototype,"isTimeout",{get:function(){return this._isTimeout},enumerable:!0,configurable:!0}),r.prototype.canClearEventListener=function(){return this._isResponseSucceed?!0:1==this.getParamByName("notReload")?!0:1==this.getParamByName("reload")&&this.reloadTimes>=3?!0:!1},r.prototype.proxyDone=function(){r.CLEAR_LISTENER&&this.canClearEventListener()&&this.clearEventListener()},r.prototype.onError=function(n){this._isRequestSucceed=!1,this._errorMessage="请求失败",this._errorCode=e.ERROR_REQUEST,egret.clearTimeout(this._timeoutId),this.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.REQUEST_FAIL,this)),this.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.ERROR,this)),t.postNotification(t.ProxyAction.REQUEST_ERROR,this),t.postNotification(t.ProxyAction.RESPONSE,this),this.proxyDone()},r.prototype.onResponse=function(n){this._responseData=n,this._isResponseSucceed=!1,this._status=t.ProxyStatus.RESPONSE,this._responseData&&this._responseData.hasOwnProperty("s")&&(this._isResponseSucceed=0==this._responseData.s),this.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.REQUEST_SUCCEED,this)),this._errorCode=this._responseData?this._responseData.s:e.ERROR_DATA,this._isRequestSucceed=!0,t.postNotification(t.ProxyAction.REQUEST_SUCCEED,this),t.postNotification(t.ProxyAction.RESPONSE,this),this._isResponseSucceed?(t.postNotification(t.ProxyAction.RESPONSE_SUCCEED,this),this.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.RESPONSE_SUCCEED,this))):(t.postNotification(t.ProxyAction.RESPONSE_ERROR,this),this.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.RESPONSE_ERROR,this)),this.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.ERROR,this))),this.proxyDone()},r.prototype.onComplete=function(t){egret.clearTimeout(this._timeoutId);var e=null;try{e=JSON.parse(t.target.response)}catch(n){}this.onResponse(e)},r.prototype.getURLVariables=function(t){var e=[];for(var n in t)e.push(n+"="+t[n]);var r=e.join("&");return new egret.URLVariables(r)},r.prototype.getParamByName=function(t){return this._params?this._params[t]:null},r.prototype.hasParamByName=function(t){return this._params?this._params.hasOwnProperty(t):!1},Object.defineProperty(r.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"responseData",{get:function(){return this._responseData},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isResponseSucceed",{get:function(){return this._isResponseSucceed},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isRequestSucceed",{get:function(){return this._isRequestSucceed},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"errorMessage",{get:function(){return this._errorMessage},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"errorCode",{get:function(){return this._errorCode},enumerable:!0,configurable:!0}),r.prototype.addParam=function(t,e){this._customParams[t]=e},r.prototype.getParamString=function(){return null},r.prototype.addEventListener=function(t,e,r,o,i){void 0===o&&(o=!1),void 0===i&&(i=0),n.prototype.addEventListener.call(this,t,e,r,o,i),this._listeners.push({type:t,listener:e,thisObj:r,capture:o,priority:i})},r.prototype.clearEventListener=function(){for(;this._listeners.length>0;){var t=this._listeners.shift();this.removeEventListener(t.type,t.listener,t.thisObj,t.capture)}},r.addGlobalParams=function(t,e){this._globalParams[t]=e},r.getGlobalParam=function(t){return this._globalParams[t]},r.removeGlobalParams=function(t){delete this._globalParams[t]},r.CLEAR_LISTENER=!0,r.hashKey="",r.request_path="",r.request_url="",r.frontProxyKeys=["mask","cache","autoMerge","delay","dataMerge"],r._timeout=2e4,r._globalParams={},r}(egret.EventDispatcher);t.Proxy=n,__reflect(n.prototype,"meru.Proxy")}(meru||(meru={}));var meru;!function(t){var e=function(){function e(){this._nameObservers={}}return e.prototype.addObserver=function(e,n,r,o){void 0===o&&(o=0);var i=t.getTypeId(r);this._nameObservers.hasOwnProperty(e)||(this._nameObservers[e]={});var a=this._nameObservers[e];a.hasOwnProperty(i)||(a[i]=[]);var s={name:e,sender:n,priority:o,context:r};return a[i].push(s),a[i]=a[i].sort(function(t,e){return e.priority-t.priority}),s},e.prototype.onceObserver=function(t,e,n,r){var o=this;void 0===r&&(r=0);var i,a=function(){e&&e.call(n),o.removeObserverByInfo(o,i)};i=this.addObserver(t,a,this,r)},e.prototype.removeObserverByInfo=function(e,n){if(t.hasTypeId(e)){var r=t.getTypeId(e),o=this._nameObservers[n.name];if(o.hasOwnProperty(r)){var i=o[r].indexOf(n);i>-1&&o[r].splice(i,1)}}},e.prototype.removeObserver=function(e,n,r){var o=this._nameObservers[e];for(var i in o){var a=o[i];t.array.remove(a,function(t){return t.sender==n&&t.context==r})}},e.prototype.removeObserverByObject=function(e){if(t.hasTypeId(e)){var n=t.getTypeId(e);for(var r in this._nameObservers){var o=this._nameObservers[r];o.hasOwnProperty(n)&&delete o[n]}}},e.prototype.removeObserverByName=function(t){this._nameObservers.hasOwnProperty(t)&&delete this._nameObservers[t]},e}();t.BaseNotification=e,__reflect(e.prototype,"meru.BaseNotification")}(meru||(meru={}));var meru;!function(t){function e(t,e,n,r){var o={};o.configurable=!0,o.enumerable=!0,o.get=n,r&&(o.set=r),Object.defineProperty(t,e,o)}function n(e,n){void 0===n&&(n=null);var r=t.Config.get("game_setting_json",""+e,null);return null!=r?r:t.Config.get("project_json","Game."+e,n)}function r(){return o||(o=t.getDefinitionInstance(t.getSetting().GameCallbackClass)),o}t.def=e,e(t,"stage",function(){return egret.MainContext.instance.stage}),t.getConst=n;var o=null;t.$getCallback=r}(meru||(meru={}));var meru;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.buttonAddStage,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.buttonRemoveStage,t),t}return __extends(n,e),Object.defineProperty(n.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"notice",{get:function(){return this._notice},set:function(t){this._notice=t},enumerable:!0,configurable:!0}),n.prototype.buttonAddStage=function(){t.addPullObject(t.k.GET_BUTTON,this.getButton,this)},n.prototype.buttonRemoveStage=function(){t.removePullObject(t.k.GET_BUTTON,this.getButton,this)},n.prototype.getButton=function(t){return this.name==t?this:void 0},n.prototype.getCurrentState=function(){var t=this.skin.currentState;if(this.selected){if(this.skin.hasState(t+"AndSelected"))return t+"AndSelected"}else if(t.indexOf("AndSelected")>-1)return t.replace("AndSelected","");return e.prototype.getCurrentState.call(this)},n.prototype.buttonReleased=function(){if(is.truthy(this._notice)){var n=this.data;if(!n){var r=t.display.getHostComponent(this);r&&(n=r.data)}var o=this.selected,i=t.pullObject(t.str.formatNotice(this._notice),n,r,this);("boolean"==typeof i&&1==i||i==n)&&(o==this.selected&&(this.selected=!this.selected),this.selected&&this.name&&t.postNotification(t.k.CLICK_BUTTON,this.name,this),this.dispatchEventWith(egret.Event.CHANGE))}else e.prototype.buttonReleased.call(this),this.name&&t.postNotification(t.k.CLICK_BUTTON,this.name,this)},n}(eui.ToggleButton);t.ToggleButton=e,__reflect(e.prototype,"meru.ToggleButton")}(meru||(meru={}));var meru;!function(t){var e=function(){function e(t){this._args=[],this._listeners=[],this._component=t,t.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemovedFromStage,this)}return e.prototype.getArgs=function(){return this._args},e.prototype.setArgs=function(t){this._args=t},e.prototype.listener=function(t,e){if(t&&e){var n=null;n=t instanceof eui.RadioButton?eui.PropertyEvent.PROPERTY_CHANGE:egret.TouchEvent.TOUCH_TAP,this._listeners.push({component:t,func:e,type:n}),t.addEventListener(n,e,this._component)}},e.prototype.onAddToStage=function(e){t.addPullObject(t.k.GetComponent,this.getComopnent,this),(n=this._component).onEnter.apply(n,this._args);var n},e.prototype.onRemovedFromStage=function(){t.removePullObject(t.k.GetComponent,this.getComopnent,this),this.clearLiteners(),this._component.onExit()},e.prototype.clearLiteners=function(){for(;this._listeners.length>0;){var t=this._listeners.shift();t.component.removeEventListener(t.type,t.func,this)}},e.prototype.getComopnent=function(t){return t==this._component.autoId&&is.truthy(t)?this._component:this._component.componentName==t&&is.truthy(t)?this._component:void 0},e}();t.ComponentState=e,__reflect(e.prototype,"meru.ComponentState")}(meru||(meru={}));var meru;!function(t){var e;!function(t){t[t.BEGIN=0]="BEGIN",t[t.MOVE=1]="MOVE",t[t.END=2]="END",t[t.INTERSECTS=3]="INTERSECTS",t[t.BACK=4]="BACK"}(e=t.DragType||(t.DragType={}));var n=function(){function n(){this._dragItems=[],this._dropItems=[],this._old=new egret.Point,this._oldParent=null,this._begin=new egret.Point,this._isDragCloneable=!1,this._originDisplay=null,this._offset=new egret.Point}return n.prototype.addDragItems=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0;r<t.length;r++){var o=t[r];is.array(o)?n=n.concat(o):is.existy(o)&&n.push(o)}for(var r=0;r<n.length;r++){var i=n[r];i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBegin,this),this._dragItems.push(i)}return this},n.prototype.setCallback=function(t){return this._callback=t,this},n.prototype.addDropItems=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;n++){var r=t[n];is.array(r)?this._dropItems=this._dropItems.concat(r):is.existy(r)&&this._dropItems.push(r)}return this},n.prototype.onBegin=function(n){this._curDragItem=n.currentTarget,this._begin.x=n.stageX,this._begin.y=n.stageY,this._old.x=this._curDragItem.x,this._old.y=this._curDragItem.y;var r=this._curDragItem.localToGlobal(0,0);if(this._offset.x=r.x-n.stageX,this._offset.y=r.y-n.stageY,this._oldParent=this._curDragItem.parent,this._originDisplay=this._curDragItem,egret.is(this._curDragItem,"meru.IDragCloneable")){var o=this._curDragItem.dragClone();o.x=r.x,o.y=r.y,t.stage.addChild(o),this._curDragItem=o,this._isDragCloneable=!0}else this._curDragItem.x=r.x,this._curDragItem.y=r.y,this._oldParent=this._curDragItem.parent,t.stage.addChild(this._curDragItem),this._isDragCloneable=!1;this._callback&&this._callback(e.BEGIN,this._originDisplay,null),t.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),t.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this)},n.prototype.onMove=function(t){this._curDragItem.x=t.stageX+this._offset.x,this._curDragItem.y=t.stageY+this._offset.y,this._callback&&this._callback(e.MOVE,this._originDisplay,null)},n.prototype.onEnd=function(n){var r=this,o=new egret.Point(n.stageX,n.stageY);t.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),t.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this);for(var i=new egret.Point,a=null,s=this.getDisplayRect(this._curDragItem),u=0;u<this._dropItems.length;u++){var c=this._dropItems[u],h=this.getDisplayRect(c);if(s.intersects(h)){a=c;break}}if(this._callback&&(this._callback(e.END,this._originDisplay,null),a&&this._callback(e.INTERSECTS,this._originDisplay,a)),a)this._isDragCloneable&&t.display.removeFromParent(this._curDragItem);else{i=this._oldParent.localToGlobal(this._old.x,this._old.y);var p=egret.Point.distance(o,i)/2;this._isDragCloneable?t.Animation.to(p,{x:i.x,y:i.y}).call(function(){t.display.removeFromParent(r._curDragItem),r._callback&&r._callback(e.BACK,r._originDisplay,null)}).run(this._curDragItem):(this._curDragItem.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBegin,this),t.Animation.to(p,{x:i.x,y:i.y}).call(function(){r._curDragItem.addEventListener(egret.TouchEvent.TOUCH_BEGIN,r.onBegin,r),r._oldParent.addChild(r._curDragItem),r._curDragItem.x=r._old.x,r._curDragItem.y=r._old.y,r._callback&&r._callback(e.BACK,r._originDisplay,null)}).run(this._curDragItem))}},n.prototype.getDisplayRect=function(t,e){void 0===e&&(e=new egret.Rectangle),e=t.getBounds(e);var n=t.localToGlobal(0,0);return e.x=n.x,e.y=n.y,e},n.prototype.dispose=function(){for(t.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),t.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this);this._dragItems.length;){var e=this._dragItems.shift();e.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBegin,this),e.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this)}},n.addDragItems=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=new n;return r.addDragItems.apply(r,t),r},n.setCallback=function(t){var e=new n;return e.setCallback(t),e},n.addDropItems=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=new n;return r.addDropItems.apply(r,t),r},n}();t.Draggable=n,__reflect(n.prototype,"meru.Draggable")}(meru||(meru={}));var meru;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n._ignoreButton=!1,n._dataMapArr=[],n._watchers=[],n._state=new t.ComponentState(n),n}return __extends(n,e),Object.defineProperty(n.prototype,"notice",{get:function(){return this._notice},set:function(t){this._notice=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"componentName",{get:function(){return this._componentName},set:function(t){this._componentName=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ignoreButton",{get:function(){return this._ignoreButton},set:function(t){this._ignoreButton=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this.$_data},set:function(t){this.$_data=t,null!=t&&this.addDataMap("data"),eui.PropertyEvent.dispatchPropertyEvent(this,eui.PropertyEvent.PROPERTY_CHANGE,"data"),this.dataChanged()},enumerable:!0,configurable:!0}),n.prototype.addDataMap=function(t){-1==this._dataMapArr.indexOf(t)&&this._dataMapArr.push(t)},n.prototype.setData=function(t,e){return void 0===e&&(e="data"),this[e]=t,null!=t&&this.addDataMap(e),this},n.prototype.dataChanged=function(){for(t.display.setAttribute(this);this._watchers.length;)this._watchers.shift().unwatch();this._watchers.push(eui.Binding.bindHandler(this.data,["selected"],this.updateSelect,this)),this._watchers.push(eui.Binding.bindHandler(this,["enabled"],this.onUpdateEnabled,this)),this.data&&is.bool(this.data.selected)&&(this.selected=this.data.selected)},n.prototype.onUpdateEnabled=function(){t.propertyChange(this,"currentState")},n.prototype.updateAttribute=function(t){this[t.name]=t.value},n.prototype.setState=function(t){return this.currentState=t,this},n.prototype.setCompName=function(t){return this.componentName=t,this},n.prototype.updateSelect=function(){this.data&&(this.selected=this.data.selected)},n.prototype.listener=function(t,e){this._state.listener(t,e)},Object.defineProperty(n.prototype,"autoId",{get:function(){return this.data?this.data.autoId:""},enumerable:!0,configurable:!0}),n.prototype.onEnter=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tap,this),t.addPullObject(t.k.GetComponent,this.getComopnent,this)},n.prototype.onExit=function(){for(;this._watchers.length;)this._watchers.shift().unwatch();t.removePullObject(t.k.GetComponent,this.getComopnent,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.tap,this)},n.prototype.getComopnent=function(t){return t==this.autoId&&is.truthy(t)?this:this.componentName==t&&is.truthy(t)?this:void 0},n.prototype.getCurrentState=function(){if(0==this.enabled&&this.skin.hasState("disabled"))return"disabled";var t=this.skin.currentState,n=e.prototype.getCurrentState.call(this);return this.skin.hasState(n)?n:t},n.prototype.destoryData=function(){for(;this._dataMapArr.length;)this[this._dataMapArr.shift()]=null;t.display.destoryChildren(this)},n.prototype.tap=function(e){return!this.ignoreButton&&e.target instanceof t.Button?void e.stopPropagation():void(is.truthy(this._notice)&&t.postNotification(t.str.formatNotice(this._notice),this.data,this))},n}(eui.ItemRenderer);t.ItemRenderer=e,__reflect(e.prototype,"meru.ItemRenderer",["meru.IComponent","egret.DisplayObject","meru.IAttributeHost"])}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){this._lastTime=0}return t.prototype.start=function(){this._lastTime=egret.getTimer(),egret.startTick(this.tick,this)},t.prototype.stop=function(){egret.stopTick(this.tick,this)},t.prototype.tick=function(t){var e=t-this._lastTime;return this._lastTime=t,dragonBones.WorldClock.clock.advanceTime(e/1e3),!1},t}();__reflect(e.prototype,"MovieClock");var n=function(){function t(){this._parseMap={}}return t.prototype.getFactory=function(t){if(this._clock||(this._clock=new e,this._clock.start()),this.factory||(this.factory=new dragonBones.EgretFactory),!this._parseMap.hasOwnProperty(t)){var n=t+"_anim.json",r=t+"_texture.json",o=t+"_texture.png",i=RES.getRes(n);if(this.factory.parseDragonBonesData(i),RES.hasRes(r)){var a=RES.getRes(r),s=RES.getRes(o);this.factory.parseTextureAtlasData(a,s)}this._parseMap[t]=!0}return this.factory},t}();t.MovieEgretFactory=n,__reflect(n.prototype,"meru.MovieEgretFactory");var r=function(){function t(t,e){this._name=t,this._playTimes=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t.prototype.play=function(t){t.play(this._name,this._playTimes)},t}();__reflect(r.prototype,"MoviePlay",["IMoviePlay"]);var o=function(e){function o(t,n){void 0===t&&(t=null),void 0===n&&(n=t);var r=e.call(this)||this;return r._armatureName=null,r._atLast=!1,r._frameRate=null,r._intialized=!1,r._prefix=null,r._replaceDisplayArr=[],r._filename=n+"_dragonGroup",t&&r.init(t,n),r}return __extends(o,e),o.prototype.gotoAndStop=function(t,e){},o.prototype.gotoAndPlay=function(t,e,n){},o.prototype.dispose=function(){},Object.defineProperty(o.prototype,"atLast",{get:function(){return this._atLast},set:function(t){this._atLast=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"frameRate",{get:function(){return this._frameRate},set:function(t){this._frameRate=t,this._armature&&(this._armature.clock.timeScale=this._frameRate/24)},enumerable:!0,configurable:!0}),o.prototype.onAddToStage=function(){this._armature&&(dragonBones.WorldClock.clock.add(this._armature),this._armature.animation&&this._armature.animation.play(),this._armature.addEventListener(dragonBones.EgretEvent.ANIMATION_FRAME_EVENT,this.onFrame,this),this._armature.addEventListener(dragonBones.EgretEvent.COMPLETE,this.onComplete,this),this._armature.addEventListener(dragonBones.EgretEvent.LOOP_COMPLETE,this.onComplete,this))},o.prototype.onRemoveFromStage=function(){dragonBones.WorldClock.clock.remove(this._armature),this._armature&&(this._armature.animation.stop(),this._armature.removeEventListener(dragonBones.EgretEvent.ANIMATION_FRAME_EVENT,this.onFrame,this),this._armature.removeEventListener(dragonBones.EgretEvent.COMPLETE,this.onComplete,this),this._armature.removeEventListener(dragonBones.EgretEvent.LOOP_COMPLETE,this.onComplete,this))
},o.prototype.init=function(t,e){void 0===e&&(e=t),this.prefix=t,this.armature=e,this._intialized||(this._intialized=!0,this.stage&&this.onAddToStage(),this.hasEventListener(egret.Event.ADDED_TO_STAGE)||this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.hasEventListener(egret.Event.REMOVED_FROM_STAGE)||this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this))},Object.defineProperty(o.prototype,"prefix",{get:function(){return this._prefix},set:function(t){this._prefix=t,t&&this.initialize(t)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"armature",{get:function(){return this._armatureName},set:function(t){this._armatureName=t},enumerable:!0,configurable:!0}),o.prototype.initialize=function(t){this._animationFile=t+"_anim.json",this._textureFile=t+"_texture.json",this._textureImage=t+"_texture.png"},o.prototype.prepareResource=function(){var t=RES.getRes(this._animationFile),e=RES.getRes(this._textureFile),n=RES.getRes(this._textureImage);return t&&e&&n?new Promise(function(t,e){t()}):(RES.createGroup(this._filename,[this._animationFile,this._textureFile,this._textureImage]),RES.loadGroup(this._filename))},o.prototype.playCore=function(t){var e=this;this._moviePlay=t,this.prepareResource().then(function(){e._play()})},o.prototype.play=function(t,e){this._prefix&&this._armatureName&&this.playCore(new r(t,e))},Object.defineProperty(o.prototype,"animationName",{get:function(){return this._armature.animation.lastAnimationState.name},enumerable:!0,configurable:!0}),o.getFrameEventCount=function(t,e,n){var r=e.name+"_"+n.name;if(!this._frameEventMap.hasOwnProperty(r)){var o=e.animation.animations[n.name];if(!o)return 0;var i=o.frames;if(!i||0==i.length)return 0;for(var a=[],s=0;s<i.length;s++){var u=i[s];if(u.events.length>0)for(var c=0;c<u.events.length;c++)-1==a.indexOf(u.events[c].name)&&u.events[c].name.indexOf(t)>-1&&a.push(u.events[c].name)}this._frameEventMap[r]=a.length}return this._frameEventMap[r]},o.prototype.getFrameEventCount=function(t){return o.getFrameEventCount(t,this._armature,this._moviePlay)},o.prototype._play=function(){if(this._armature)return void this._moviePlay.play(this._armature.animation);var e=t.singleton(n).getFactory(this._prefix);for(dragonBones.WorldClock.clock.remove(this._armature),this._armature=e.buildArmature(this._armatureName),this._armature.display.x=0,this._armature.display.y=0,this._moviePlay.play(this._armature.animation),this._armature.addEventListener(dragonBones.EgretEvent.FRAME_EVENT,this.onFrame,this),this._armature.addEventListener(dragonBones.EgretEvent.COMPLETE,this.onComplete,this),this._armature.addEventListener(dragonBones.EgretEvent.LOOP_COMPLETE,this.onComplete,this),this.addChild(this._armature.display);this._replaceDisplayArr.length>0;){var r=this._replaceDisplayArr.shift();this.replaceDisplay(r.name,r.display)}dragonBones.WorldClock.clock.add(this._armature),this._frameRate&&(this.frameRate=this._frameRate)},o.prototype.onFrame=function(e){var n=new t.MovieEvent(t.MovieEvent.FRAME_LABEL,e.frameLabel);this.dispatchEvent(n)},o.prototype.onComplete=function(e){this.dispatchEvent(new t.MovieEvent(t.MovieEvent.COMPLETE))},o.prototype.replaceDisplay=function(t,e){if(this._armature){var n=this._armature.getSlot(t);n.displayIndex=0,n.display=e}else this._replaceDisplayArr.push({name:t,display:e})},o._frameEventMap={},o}(egret.DisplayObjectContainer);t.DragonMovie=o,__reflect(o.prototype,"meru.DragonMovie",["meru.IMovie","egret.DisplayObject"])}(meru||(meru={}));var meru;!function(t){function e(t){var e=t.split("/"),n=e[e.length-1];return e=n.split("."),e[0]}var n=function(t){function e(e,n){void 0===n&&(n=null);var r=t.call(this,e)||this;return r._frameLabel=n,r}return __extends(e,t),Object.defineProperty(e.prototype,"frameLabel",{get:function(){return this._frameLabel},enumerable:!0,configurable:!0}),e.FRAME_LABEL="Frame_Label",e.LOOP_COMPLETE="Loop_Complete",e.COMPLETE="Complete",e}(egret.Event);t.MovieEvent=n,__reflect(n.prototype,"meru.MovieEvent");var r=function(r){function o(t){var n=r.call(this)||this;return n._atLast=!1,n._frameRate=null,n._dataPath=t,n._texturePath=t.replace("_ske.dbmv","_tex.png"),n._filename=e(n._dataPath).replace("_ske",""),n}return __extends(o,r),Object.defineProperty(o.prototype,"atLast",{get:function(){return this._atLast},set:function(t){this._atLast=t},enumerable:!0,configurable:!0}),o.prototype.prepareResource=function(){var t=RES.getRes(this._dataPath),e=RES.getRes(this._texturePath);return t&&e?new Promise(function(t,e){t()}):(RES.createGroup(this._filename,[this._dataPath]),RES.loadGroup(this._filename))},o.prototype.play=function(t,e){var n=this;void 0===e&&(e=0),e=0==e?-1:-1==e?0:e,this.prepareResource().then(function(){n.getMC().play(t,e)})},o.prototype.gotoAndStop=function(t,e){var n=this;this.prepareResource().then(function(){n.getMC().gotoAndStop(t,e/24)})},o.prototype.gotoAndPlay=function(t,e,n){var r=this;void 0===n&&(n=0),n=0==n?-1:-1==n?0:n,this.prepareResource().then(function(){r.getMC().gotoAndPlay(t,e/24,n)})},o.prototype.clearEvents=function(){this._mc&&(this._mc.removeEventListener(dragonBones.MovieEvent.LOOP_COMPLETE,this.onLoopComplete,this),this._mc.removeEventListener(dragonBones.MovieEvent.COMPLETE,this.onComplete,this),this._mc.removeEventListener(dragonBones.MovieEvent.FRAME_EVENT,this.onFrameLabel,this))},o.prototype.initEvents=function(){this._mc&&(this._mc.addEventListener(dragonBones.MovieEvent.LOOP_COMPLETE,this.onLoopComplete,this),this._mc.addEventListener(dragonBones.MovieEvent.COMPLETE,this.onComplete,this),this._mc.addEventListener(dragonBones.MovieEvent.FRAME_EVENT,this.onFrameLabel,this))},o.prototype.getMC=function(){return this.dispose(),this._mc=dragonBones.buildMovie(this._filename),this.initEvents(),this._mc&&null!=this._frameRate&&(this._mc.clipTimeScale=this._frameRate/24),this.addChild(this._mc),this._mc},o.prototype.onLoopComplete=function(t){this.dispatchEvent(new n(n.LOOP_COMPLETE))},o.prototype.onComplete=function(e){this.dispatchEvent(new n(n.COMPLETE)),this.atLast||t.display.removeFromParent(this)},Object.defineProperty(o.prototype,"frameRate",{get:function(){return this._frameRate},set:function(t){this._frameRate=t,this._mc&&(this._mc.clipTimeScale=this._frameRate/24)},enumerable:!0,configurable:!0}),o.prototype.onFrameLabel=function(t){this.dispatchEvent(new n(n.FRAME_LABEL,t.name))},o.prototype.dispose=function(){this._mc&&(this._mc.dispose(),this.clearEvents(),t.display.removeFromParent(this._mc))},o}(egret.DisplayObjectContainer);__reflect(r.prototype,"DBFaseMovie",["meru.IMovie","egret.DisplayObject"]);var o=function(e){function n(t){var n=e.call(this)||this;return n._curIndex=0,n._atLast=!1,n._frameRate=0,n._frameIntervalTime=0,n._passedTime=0,n._events=[],n._template=t,n.$renderNode=new egret.sys.BitmapNode,n.frameRate=24,n}return __extends(n,e),n.prototype.gotoAndStop=function(t,e){throw new Error("未实现")},n.prototype.gotoAndPlay=function(t,e,n){throw void 0===n&&(n=0),new Error("未实现")},Object.defineProperty(n.prototype,"atLast",{get:function(){return this._atLast},set:function(t){this._atLast=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"frameRate",{get:function(){return this._frameRate},set:function(t){this._frameRate=t,this._frameIntervalTime=1e3/t},enumerable:!0,configurable:!0}),n.prototype.play=function(t,e){void 0===e&&(e=0),0==e&&(e=1),this._playTimes=e;var n=t.split(":");this._start=parseInt(n[0]),this._end=parseInt(n[1]),this._curIndex=this._start,egret.stopTick(this.tick,this),this._lastTime=egret.getTimer(),egret.startTick(this.tick,this)},n.prototype.tick=function(t){var e=t-this._lastTime;this._lastTime=t;var n=this._frameIntervalTime,r=this._passedTime+e;this._passedTime=r%n;var o=r/n;if(1>o)return!1;for(;o>=1;)if(o--,this._curIndex++,this._curIndex>this._end)if(-1==this._playTimes)this._events.push(egret.Event.LOOP_COMPLETE),this._curIndex=this._start;else{if(this._playTimes--,!(this._playTimes>0)){this._curIndex=this._end,this._events.push(egret.Event.COMPLETE),this.stop();break}this._events.push(egret.Event.LOOP_COMPLETE),this._curIndex=this._start}return this.constructFrame(),this.handlePendingEvent(),!1},n.prototype.$render=function(){var t=this._bitmapData;if(t){var e=Math.round(0),n=Math.round(0),r=t._bitmapWidth,o=t._bitmapHeight,i=t.$getTextureWidth(),a=t.$getTextureHeight(),s=Math.round(t.$getScaleBitmapWidth()),u=Math.round(t.$getScaleBitmapHeight()),c=t._sourceWidth,h=t._sourceHeight;egret.sys.BitmapNode.$updateTextureData(this.$renderNode,t._bitmapData,t._bitmapX,t._bitmapY,r,o,e,n,i,a,s,u,c,h,null,egret.BitmapFillMode.SCALE,!0)}},n.prototype.$measureContentBounds=function(t){var e=this._bitmapData;if(e){var n=0,r=0,o=e.$getTextureWidth(),i=e.$getTextureHeight();t.setTo(n,r,o,i)}else t.setEmpty()},n.prototype.handlePendingEvent=function(){if(0!=this._events.length){this._events.reverse();for(var e=this._events,n=e.length,r=!1,o=!1,i=0;n>i;i++){var a=e.pop();a==egret.Event.LOOP_COMPLETE?o=!0:a==egret.Event.COMPLETE?r=!0:this.dispatchEventWith(a)}o&&this.dispatchEventWith(egret.Event.LOOP_COMPLETE),r&&(this.dispatchEventWith(egret.Event.COMPLETE),this.atLast||(this.stop(),t.display.removeFromParent(this)))}},n.prototype.stop=function(){egret.stopTick(this.tick,this)},n.prototype.getTextureName=function(t){return this._template.replace(a._dnumRegex,function(e,n,r,o){if(!is.undefined(r)&&!is.undefined(o)){var i=parseInt(o),a=""+t;return a.length>=i?a:new Array(i-a.length+1).join(r)+a}return t+""})},n.prototype.constructFrame=function(){this._bitmapData=RES.getRes(this.getTextureName(this._curIndex)),this.$invalidateContentBounds()},n.prototype.dispose=function(){egret.stopTick(this.tick,this)},n}(egret.DisplayObjectContainer);__reflect(o.prototype,"SequnceMovie",["meru.IMovie","egret.DisplayObject"]);var i=function(r){function o(t){var n=r.call(this)||this;return n._atLast=!1,n._frameRate=null,n._dataPath=t,n._texturePath=t.replace(".json",".png"),n._filename=e(n._dataPath),n}return __extends(o,r),Object.defineProperty(o.prototype,"atLast",{get:function(){return this._atLast},set:function(t){this._atLast=t},enumerable:!0,configurable:!0}),o.prototype.prepareResource=function(){var t=RES.getRes(this._dataPath);return t?new Promise(function(t){t()}):(RES.createGroup(this._filename,[this._dataPath]),RES.loadGroup(this._filename))},o.prototype.play=function(t,e){var n=this;void 0===e&&(e=0),this.prepareResource().then(function(){n.getMC(t).play(e)})},o.prototype.gotoAndStop=function(t,e){var n=this;this.prepareResource().then(function(){n.getMC(t).gotoAndStop(e)})},o.prototype.gotoAndPlay=function(t,e,n){var r=this;void 0===n&&(n=0),this.prepareResource().then(function(){r.getMC(t).gotoAndPlay(e,n)})},Object.defineProperty(o.prototype,"frameRate",{get:function(){return this._frameRate},set:function(t){this._frameRate=t,this._mc&&(this._mc.frameRate=t)},enumerable:!0,configurable:!0}),o.prototype.clearEvents=function(){this._mc&&(this._mc.removeEventListener(egret.MovieClipEvent.LOOP_COMPLETE,this.onLoopComplete,this),this._mc.removeEventListener(egret.MovieClipEvent.COMPLETE,this.onComplete,this),this._mc.removeEventListener(egret.MovieClipEvent.FRAME_LABEL,this.onFrameLabel,this))},o.prototype.initEvents=function(){this._mc&&(this._mc.addEventListener(egret.MovieClipEvent.LOOP_COMPLETE,this.onLoopComplete,this),this._mc.addEventListener(egret.MovieClipEvent.COMPLETE,this.onComplete,this),this._mc.addEventListener(egret.MovieClipEvent.FRAME_LABEL,this.onFrameLabel,this))},o.prototype.getMC=function(e){var n=RES.getRes(this._dataPath);return n?(this._mc&&(this.clearEvents(),t.display.removeFromParent(this._mc)),this._mc=new egret.MovieClip(n.generateMovieClipData(e)),null!=this._frameRate&&(this._mc.frameRate=this._frameRate),this.initEvents(),this.addChild(this._mc),this._mc):null},o.prototype.onLoopComplete=function(t){this.dispatchEvent(new n(n.LOOP_COMPLETE))},o.prototype.onComplete=function(e){this.dispatchEvent(new n(n.COMPLETE)),this.atLast||t.display.removeFromParent(this)},o.prototype.onFrameLabel=function(t){this.dispatchEvent(new n(n.FRAME_LABEL,t.frameLabel))},o.prototype.dispose=function(){this.clearEvents()},o}(egret.DisplayObjectContainer);__reflect(i.prototype,"MovieClip",["meru.IMovie","egret.DisplayObject"]);var a=function(){function e(){}return e.create=function(n,a){var s=n.split("/"),u=s[s.length-1];return s.indexOf("dragon")>-1?(null==a&&(a=u),new t.DragonMovie(n,a)):u.indexOf(".dbmv")>-1?new r(n):-1==u.indexOf("_")?new i(n):(e._dnumRegex.lastIndex=0,e._dnumRegex.test(n)?new o(n):void 0)},e._dnumRegex=/\{((.+)(\d+))?d\}/gi,e}();t.MovieFactory=a,__reflect(a.prototype,"meru.MovieFactory")}(meru||(meru={}));var meru;!function(t){var e=function(e){function n(t){var n=e.call(this)||this;return n._targetDispaly=t,n}return __extends(n,e),n.prototype.getShowBoxAnmation=function(e){var n=0,r=0,o=this.component,i=this._targetDispaly.localToGlobal(0,0);return i=o.globalToLocal(i.x,i.y,i),i.x-=o.width/2,i.y-=o.height/2,e.verticalCenter=i.y,e.horizontalCenter=i.x,e.scaleX=e.scaleY=0,e.alpha=0,t.Animation.to(150,{alpha:1,verticalCenter:r,horizontalCenter:n,scaleX:1,scaleY:1}).run(e)},n.prototype.getShowMaskAnimation=function(e){var n=e.alpha;return e.alpha=0,t.Animation.to(150,{alpha:n}).run(e)},n.prototype.getCloseBoxAnimation=function(e){var n=this.component,r=this._targetDispaly.localToGlobal(0,0);return r=n.globalToLocal(r.x,r.y,r),r.x-=n.width/2,r.y-=n.height/2,t.Animation.setTarget(e).to(150,{alpha:0,verticalCenter:r.y,horizontalCenter:r.x,scaleX:0,scaleY:0})},n.prototype.getCloseMaskAnimation=function(e){return t.Animation.setTarget(e).to(150,{alpha:0})},n}(t.BaseBoxAnimation);t.OpenBoxAnimation=e,__reflect(e.prototype,"meru.OpenBoxAnimation")}(meru||(meru={}));var meru;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,eui.PropertyEvent.dispatchPropertyEvent(this,eui.PropertyEvent.PROPERTY_CHANGE,"data")},enumerable:!0,configurable:!0}),e}(eui.ProgressBar);t.ProgressBar=e,__reflect(e.prototype,"meru.ProgressBar")}(meru||(meru={}));var meru;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.customState=null,t}return __extends(n,e),Object.defineProperty(n.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"notice",{get:function(){return this._notice},set:function(t){this._notice=t},enumerable:!0,configurable:!0}),n.prototype.getCurrentState=function(){var t=this.customState;if(t||(t=this.skin.currentState),this.selected){if(this.skin.hasState(t+"AndSelected"))return t+"AndSelected"}else if(t.indexOf("AndSelected")>-1)return t.replace("AndSelected","");return t},n.prototype.buttonReleased=function(){if(is.truthy(this._notice)){var n=this.data;if(!n){var r=t.display.getHostComponent(this);r&&(n=r.data)}var o=this.selected,i=t.pullObject(t.str.formatNotice(this._notice),n,r,this);("boolean"==typeof i&&1==i||i==n)&&(o==this.selected&&(this.selected=!this.selected),this.dispatchEventWith(egret.Event.CHANGE))}else e.prototype.buttonReleased.call(this)},n}(eui.RadioButton);t.RadioButton=e,__reflect(e.prototype,"meru.RadioButton")}(meru||(meru={}));var meru;!function(t){var e=function(){function t(t){this._resourceGroup=t}return Object.defineProperty(t.prototype,"loadUpdate",{get:function(){return this._loadUpdate},set:function(t){this._loadUpdate=t},enumerable:!0,configurable:!0}),t.prototype.load=function(){var t=this._resourceGroup.getRes(),e=this._resourceGroup.name;t.length>0?(RES.createGroup(e,t,!0),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onLoaded,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onProgress,this),RES.loadGroup(e)):this._loadUpdate&&(this._loadUpdate.update(0,0),this._loadUpdate.onComplete())},t.prototype.onLoaded=function(t){t.groupName==this._resourceGroup.name&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onLoaded,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onProgress,this),this._loadUpdate&&this._loadUpdate.onComplete())},t.prototype.onProgress=function(t){this._loadUpdate&&this._loadUpdate.update(t.itemsLoaded,t.itemsTotal)},t}();t.ResourceLoad=e,__reflect(e.prototype,"meru.ResourceLoad",["meru.ILoad"])}(meru||(meru={}));var meru;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onRendererTouchEnd=function(e){if(this._sel){var n=e.currentTarget,r=this._sel.call(this._context,n.itemIndex,n);(1==r||is.undefined(r))&&t.prototype.onRendererTouchEnd.call(this,e)}else t.prototype.onRendererTouchEnd.call(this,e)},e.prototype.onVerifyCallback=function(t,e){this._sel=t,this._context=e},e}(eui.TabBar);t.TabBar=e,__reflect(e.prototype,"meru.TabBar")}(meru||(meru={}));var meru;!function(t){var e=function(){function t(t,e,n,r){void 0===t&&(t=3),void 0===e&&(e=30),void 0===n&&(n=40),void 0===r&&(r=20),this.theta=t,this.radius=e,this.distnace=n,this.rate=r}return t}();t.WanderInfo=e,__reflect(e.prototype,"meru.WanderInfo");var n=function(){function t(t,e){void 0===t&&(t=50),void 0===e&&(e=.4),this.radius=t,this.weight=e}return t}();t.AlignmentInfo=n,__reflect(n.prototype,"meru.AlignmentInfo");var r=function(){function t(t,e){void 0===t&&(t=10),void 0===e&&(e=1),this.radius=t,this.weight=e}return t}();t.SeparationInfo=r,__reflect(r.prototype,"meru.SeparationInfo");var o=function(){function t(t,e){void 0===t&&(t=100),void 0===e&&(e=.2),this.radius=t,this.weight=e}return t}();t.CohesionInfo=o,__reflect(o.prototype,"meru.CohesionInfo");var i=function(){function i(e,n){this._acceleration=new t.Vec2d,this._velocity=new t.Vec2d,this._location=new t.Vec2d(e,n),this._radius=2,this._maxForce=5,this._maxSpeed=5}return i.prototype.update=function(){this._velocity.add(this._acceleration),this._velocity.limit(this._maxSpeed),this._location.add(this._velocity),this._acceleration.mul(0)},i.prototype.applyForce=function(t){this._acceleration.add(t)},i.prototype.wander=function(){var e=this.wanderInfo.radius,n=this.wanderInfo.distnace,r=this.wanderInfo.rate;this.wanderInfo.theta+=t.num.randInt(-r,r);var o=this._velocity.clone();o.normalize(),o.mul(n),o.add(this._location);var i=new t.Vec2d(e*Math.cos(this.wanderInfo.theta),e*Math.sin(this.wanderInfo.theta)),a=t.Vec2d.add(o,i);this.applyForce(this.steer(a,!1))},i.prototype.steer=function(e,n){var r,o=t.Vec2d.sub(e,this._location),i=o.length;if(i>0){o.normalize();var a=3*this._maxSpeed;n&&a>i?o.mul(i/a*this._maxSpeed):o.mul(this._maxSpeed),r=t.Vec2d.sub(o,this._velocity),r.limit(this._maxForce)}else r=new t.Vec2d(0,0);return r},i.prototype.seek=function(t){this.applyForce(this.steer(t,!1))},i.prototype.arrive=function(t){this.applyForce(this.steer(t,!0))},i.prototype.flee=function(t){var e=this.steer(t,!1);e.mul(-1),this.applyForce(e)},i.prototype.pursue=function(e){var n=t.Vec2d.sub(e.location,this.location).length;n/=e.maxSpeed;var r=t.Vec2d.add(e.location,t.Vec2d.mul(e.velocity,n));return this.seek(r)},i.prototype.evade=function(e){var n=t.Vec2d.sub(e.location,this.location).length;n/=e.maxSpeed;var r=t.Vec2d.add(e.location,t.Vec2d.mul(e.velocity,n));this.flee(r)},i.prototype.cohere=function(e){for(var n=new t.Vec2d,r=0,o=0;o<e.length;o++){var i=e[o];i!=this&&(this.location.distance(i.location)>=this.cohesionInfo.radius||(n.add(i.location),r++))}return 0==r?n:(n.mul(1/r),n=t.Vec2d.sub(n,this.location),n.normalize(),n.mul(this.cohesionInfo.weight),this.applyForce(n),n)},i.prototype.align=function(e){for(var n=new t.Vec2d,r=0,o=0;o<e.length;o++){var i=e[o];i!=this&&(this.location.distance(i.location)>=this.alignInfo.radius||(n.add(i.velocity),r++))}return 0==r?n:(n.mul(1/r),n.normalize(),n.mul(this.alignInfo.weight),this.applyForce(n),n)},i.prototype.separate=function(e){for(var n=new t.Vec2d,r=0,o=0;o<e.length;o++){var i=e[o];i!=this&&(this.location.distance(i.location)>=this.separationInfo.radius||(n.add(t.Vec2d.sub(i.location,this.location)),r++))}0!=r&&(n.mul(-1/r),n.normalize(),n.mul(this.separationInfo.weight),this.applyForce(n))},i.prototype.flock=function(t){this.cohere(t),this.align(t),this.separate(t)},i.prototype.followPath=function(t){var e=t.current;return void 0===e?!1:this._location.distance(e)>this._radius+t.pathWidth?(this.seek(e),!0):(e=t.next(),void 0===e?!1:(this.seek(e),!0))},i.prototype.follow=function(t){this.followPath(t)||this.wander()},i.prototype.isEqual=function(t){return t instanceof i?this==t:t.isEqual(this)},Object.defineProperty(i.prototype,"location",{get:function(){return this._location},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"velocity",{get:function(){return this._velocity},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxForce",{get:function(){return this._maxForce},set:function(t){this._maxForce=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxSpeed",{get:function(){return this._maxSpeed},set:function(t){this._maxSpeed=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"wanderInfo",{get:function(){return null==this._wanderInfo&&(this._wanderInfo=new e),this._wanderInfo},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cohesionInfo",{get:function(){return null==this._cohesionInfo&&(this._cohesionInfo=new o),this._cohesionInfo},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"alignInfo",{get:function(){return null==this._alignInfo&&(this._alignInfo=new n),this._alignInfo},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"separationInfo",{get:function(){return null==this._separationInfo&&(this._separationInfo=new r),this._separationInfo},enumerable:!0,configurable:!0}),i}();t.Vehicle=i,__reflect(i.prototype,"meru.Vehicle",["meru.IVehicle"])}(meru||(meru={}));var meru;!function(t){function e(e){if(!_.hasOwnProperty(e)){var n=t.getDefinitionInstance(t.getSetting().ProgressLoadingClass,null,e);n&&(t.UI.addTooltip(n),_[e]=n)}return _[e]}function n(){var e=t.getDefinitionInstance(t.getSetting().LoadSceneClass,null);return e&&t.UI.runScene(e),e}function r(){return d||(d=t.getDefinitionInstance(t.getSetting().SimpleLoadingClass,null),d&&t.UI.addTooltip(d)),d}function o(){var t=r();t&&t.show()}function i(){var t=r();t&&t.hide()}function a(e){var n;return egret.is(e,"meru.ILoad")?n=e:egret.is(e,"meru.IResourceGroup")&&(n=new t.ResourceLoad(e)),n}function s(t,n){void 0===n&&(n="");var r=new Promise(function(r,o){var i=e(n);if(i){var s=a(t);i.load=s,i.setComplete(function(){r()}),s.loadUpdate=i,i.show()}else o()});return r}function u(t){var e=new Promise(function(e,r){var o=n();if(o){var i=a(t);o.load=i,o.setComplete(function(){e()}),i.loadUpdate=o,o.show()}});return e}function c(t){var n=e(t);n&&n.hide()}function h(){return m||(m=t.getDefinitionInstance(t.getSetting().TooltipClass),m&&t.UI.addTooltip(m)),m}function p(t,e){var n=h();n&&n.show(t,e)}function l(t,e,n){var r=h();r&&r.customView(t,e,n)}function f(e,n){var r=this;void 0===n&&(n=y.Box);for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];var a=new Promise(function(i,a){var s=t.getDefinitionInstance(t.getSetting().ConfirmClass,null,e);s&&(n==y.Box?t.UI.addBox(s):n==y.HistoryBox?(u=t.UI).addHistoryBox.apply(u,[s].concat(o)):n==y.SequnceBox?(c=t.UI).addSequenceBox.apply(c,[s].concat(o)):n==y.GroupSequnceBox&&t.UI.addGroupSequenceBox(s,o[0],o[1],o.slice(2)),s.show(function(e){e==t.ConfirmButton.yes?i():a(e)},r));var u,c});return a}var d,_={};t.showSimpleLoading=o,t.hideSimpleLoading=i,t.getResLoad=a,t.showProgressLoading=s,t.showLoadScene=u,t.hideProgressLoading=c;var m;t.tooltip=p,t.customTooltip=l;var y;!function(t){t[t.Box=0]="Box",t[t.HistoryBox=1]="HistoryBox",t[t.SequnceBox=2]="SequnceBox",t[t.GroupSequnceBox=3]="GroupSequnceBox"}(y=t.BoxType||(t.BoxType={})),t.confirm=f}(meru||(meru={}));var meru;!function(t){var e;!function(t){t[t.close=0]="close",t[t.yes=1]="yes",t[t.no=2]="no"}(e=t.ConfirmButton||(t.ConfirmButton={}))}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){this._history=[]}return t.prototype.pushHistory=function(t,e,n,r){void 0===r&&(r=[]),this._history.push({type:t,args:e,isUnder:n,hookList:r})},Object.defineProperty(t.prototype,"count",{get:function(){return this._history.length},enumerable:!0,configurable:!0}),t.prototype.hasHistory=function(){return this._history.length>0},t.prototype.clear=function(){this._history.length=0},t.prototype.popHistory=function(){return this._history.pop()},t}();t.UIHistory=e,__reflect(e.prototype,"meru.UIHistory");var n=function(t){function e(e,n,r){void 0===r&&(r=null);var o=t.call(this,e)||this;return o._component=n,o._group=r,o}return __extends(e,t),Object.defineProperty(e.prototype,"component",{get:function(){return this._component},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"group",{get:function(){return this._group},enumerable:!0,configurable:!0}),e.SHOW_PANEL="showpanel",e.HIDE_PANEL="hidepanel",e.ADD_BOX="addbox",e.CLEAR_SEQUENCE_BOX="clear_sequence",e.REMOVE_BOX="removebox",e.RUN_SCENE="runscene",e.REMOVE_SCENE="removescene",e.SET_MENU="setmenu",e.REMOVE_MENU="removemenu",e.ADD_TOOLTIP="addtooltip",e.REMOVE_TOOLTIP="removetooltip",e.ADD_GUIDE="addguide",e.REMOVE_GUIDE="remove_guide",e.ADD_COMPONENT="add_component",e.REMOVE_COMPONENT="remove_component",e.ADD_COMMON="add_common",e.REMOVE_COMMON="remove_common",e}(egret.Event);t.UIEvent=n,__reflect(n.prototype,"meru.UIEvent");var r;!function(t){t[t.MIN=0]="MIN",t[t.TOOLTIP=1]="TOOLTIP",t[t.GUIDE=2]="GUIDE",t[t.BOX=3]="BOX",t[t.COMMON=4]="COMMON",t[t.PANEL=5]="PANEL",t[t.MENU=6]="MENU",t[t.SCENE=7]="SCENE",t[t.ANY=9]="ANY"}(r=t.UIType||(t.UIType={}));var o=function(o){function i(){var t=o.call(this)||this;return t._panelTypeMap={},t._panelInstanceMap={},t._currentPanel=null,t._sequenceBoxMap={},t.touchEnabled=!1,t._scene=new eui.UILayer,t._scene.touchEnabled=!1,t.addChild(t._scene),t._common=new eui.UILayer,t._common.touchEnabled=!1,t.addChild(t._common),t._panel=new eui.UILayer,t._panel.touchEnabled=!1,t.addChild(t._panel),t._menu=new eui.UILayer,t._menu.touchEnabled=!1,t.addChild(t._menu),t._topScene=new eui.UILayer,t._topScene.touchEnabled=!1,t.addChild(t._topScene),t._box=new eui.UILayer,t._box.touchEnabled=!1,t.addChild(t._box),t._guide=new eui.UILayer,t._guide.touchEnabled=!1,t.addChild(t._guide),t._tooltip=new eui.UILayer,t._tooltip.touchEnabled=!1,t.addChild(t._tooltip),t._containerArr=[t._scene,t._topScene,t._menu,t._panel,t._common,t._box,t._guide,t._tooltip],t}return __extends(i,o),i.prototype.injectionPanel=function(t,e,n){this._panelTypeMap[t]={name:t,type:e,args:n}},i.prototype.hidePanel=function(t){null==t?this.setPanelHide(this._currentPanel):is.string(t)?this.setPanelHide(this._panelInstanceMap[t]):this.setPanelHide(t)},i.prototype.panelIsDisplay=function(t){return this._currentPanel&&this._currentPanel.getComponentName()==t?this._currentPanel.visible:!1},i.prototype.panelInInstanceMap=function(t){for(var e in this._panelInstanceMap)if(this._panelInstanceMap[e]==t)return!0;return!1},i.prototype.setPanelHide=function(t){this._currentPanel&&this._currentPanel==t&&(this.onExit(this._currentPanel,!this.panelInInstanceMap(t)),this.dispatchEvent(new n(n.HIDE_PANEL,this._currentPanel)))},i.prototype.showAnimation=function(t){egret.callLater(function(){t.animation.show(function(){})},this)},i.prototype.onEnter=function(t){var e=this;t.animation&&(t.visible=!0,t.stage?this.showAnimation(t):t.once(egret.Event.ADDED_TO_STAGE,function(){e.showAnimation(t)},this))},i.prototype.clearBox=function(){this.boxHistory.clear();for(var e=this._box.numChildren-1;e>=0;e--){var n=this._box.getChildAt(e);t.UI.remove(n,!1)}},i.prototype.onExit=function(e,n){e.animation?e.animation.close(function(){e.visible=!1,n&&(e.destoryData(),t.display.removeFromParent(e,!0))}):n&&(e.destoryData(),t.display.removeFromParent(e,!0))},i.prototype.setAnimation=function(t,e){if(!e.animation&&t){var n=egret.getDefinitionByName(t);if(n){var r=new n;e.animation=r}}},i.prototype._showPanel=function(e,o){if(this.setPanelHide(this._currentPanel),!this._panelInstanceMap.hasOwnProperty(e)){var i=this._panelTypeMap[e],a=new((s=i.type).bind.apply(s,[void 0].concat(i.args)));this._panelInstanceMap[e]=a,a.componentName=e,t.display.setFullDisplay(a),this._panel.addChild(this._panelInstanceMap[e])}return this._currentPanel=this._panelInstanceMap[e],this._currentPanel.setType(r.PANEL),this._currentPanel.setArgs&&(u=this._currentPanel).setArgs.apply(u,o),this.setAnimation(t.getSetting().PanelAnimation,this._currentPanel),this.onEnter(this._currentPanel),this.dispatchEvent(new n(n.SHOW_PANEL,this._currentPanel)),this._currentPanel;var s,u},Object.defineProperty(i.prototype,"boxHistory",{get:function(){return t.typeSingleton("__UI_BOX__",e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"panelHistory",{get:function(){return t.typeSingleton("__UI_PANEL__",e)},enumerable:!0,configurable:!0}),i.prototype.addSequnceBox=function(t,e,n,r,o){void 0===o&&(o=null),this._sequenceBoxMap.hasOwnProperty(e)||(this._sequenceBoxMap[e]=[]);var i=this._sequenceBoxMap[e],a={boxType:t,group:e,args:r,priority:n,type:o};0==i.length&&"_normal_"==e?this.runSeqBox(i,e,a):(i.push(a),-9999!=n&&(i=i.sort(function(t,e){return e.priority-t.priority})))},i.prototype.getSequnceCount=function(t){var e=this._sequenceBoxMap[t];return e&&e.length>0?e.length:0},i.prototype.runSequnceBox=function(t){var e=this._sequenceBoxMap[t];if(e&&e.length>0){var n=e.shift();this.runSeqBox(e,t,n)}},i.prototype.runSeqBox=function(t,e,n){var r=this,o=null;"fun"==n.type?(o=n.args[0],egret.callLater(function(){o(function(){r.onRemoveBox(o)})},this)):o=this.addBox(n.boxType,n.args),o.__box_group__=e,t.push(o)},i.prototype.onRemoveBox=function(t){var e=t.__box_group__;if(e){var r=this._sequenceBoxMap[e];if(r){var o=r.indexOf(t);if(o>-1&&r.splice(o,1),0==r.length)delete this._sequenceBoxMap[e],this.dispatchEvent(new n(n.CLEAR_SEQUENCE_BOX,null,e));else{var i=r.shift();this.runSeqBox(r,e,i)}}}},i.prototype.showHistoryPanel=function(t,e){var n=[],r={setData:function(t,e){n.push({action:"setData",data:t,type:e})},addOperate:function(t){n.push({action:"addOperate",operate:t,data:t.serialize()})}};this.panelHistory.pushHistory(t,e,!1,n);var o=this.showPanel(t,e);return o.hook=r,o.setHistoryComponent(!0),o},i.prototype.addHistoryBox=function(e,n){for(var r=this._box.numChildren-1;r>=0;r--){var o=this._box.getChildAt(r);o.isHistoryComponent()===!0&&t.display.removeFromParent(o,!0)}this.boxHistory.pushHistory(e,n,!1);var i=this.addBox(e,n);i.setHistoryComponent(!0)},i.prototype.getTypeInst=function(e,n,o,i){var a,s=null;return"string"==typeof e&&(a=e,e=i==r.BOX?t.getDefinitionType(t.getSetting().BoxClass,t.BaseComponent):t.BaseComponent),"Function"==e.constructor.name?s=new(e.bind.apply(e,[void 0].concat(o))):(s=e,s.setManual&&s.setManual(!0),s.setArgs&&s.setArgs(o)),a&&(s.skinName=a),egret.is(s,"meru.BaseComponent")&&s.setType(i),this.setAnimation(n,s),this.onEnter(s),s},i.prototype._addPanel=function(e,o){this.hidePanel(this._currentPanel);var i=this.getTypeInst(e,t.getSetting().PanelAnimation,o,r.PANEL);return t.display.setFullDisplay(i),this._panel.addChild(i),this._currentPanel=i,this.dispatchEvent(new n(n.SHOW_PANEL,i)),i},i.prototype.addBox=function(e,o){var i=this.getTypeInst(e,t.getSetting().BoxAnimation,o,r.BOX);return t.display.setFullDisplay(i),this._box.addChild(i),this.dispatchEvent(new n(n.ADD_BOX,i)),this.dispatchEvent(new n(n.ADD_COMPONENT,i)),i},i.prototype.checkHistory=function(t,e,n){if(e)if(t){if(e.hasHistory()){e.popHistory();var r=e.popHistory();r&&n(r)}}else e.clear()},i.prototype.remove=function(t,e,o){var i=this;
void 0===e&&(e=null),void 0===o&&(o=!0);var a=e;null==e&&t.isHistoryComponent()&&(a=!0),t.isType(r.BOX)===!0?(this.onExit(t,!0),o&&this.checkHistory(a,this.boxHistory,function(t){return i.addHistoryBox(t.type,t.args)})):t.isType(r.SCENE)===!0?(this.onExit(t,!0),o&&this.checkHistory(a,this.sceneHistory,function(t){return i.addScene(t.type,t.isUnder,t.args)})):t.isType(r.PANEL)===!0?(this.hidePanel(t),o&&this.checkHistory(a,this.panelHistory,function(t){i.restoreHookList(i.showHistoryPanel(t.type,t.args),t.hookList)})):this.onExit(t,!0),t.isType(r.BOX)===!0?(this.dispatchEvent(new n(n.REMOVE_BOX,t)),this.dispatchEvent(new n(n.REMOVE_COMPONENT,t)),this.onRemoveBox(t)):t.isType(r.SCENE)===!0?(this.dispatchEvent(new n(n.REMOVE_SCENE,t)),this.dispatchEvent(new n(n.REMOVE_COMPONENT,t))):t.isType(r.MENU)===!0?(this.dispatchEvent(new n(n.REMOVE_MENU,t)),this.dispatchEvent(new n(n.REMOVE_COMPONENT,t))):t.isType(r.GUIDE)===!0?(this.dispatchEvent(new n(n.REMOVE_GUIDE,t)),this.dispatchEvent(new n(n.REMOVE_COMPONENT,t))):t.isType(r.TOOLTIP)===!0?(this.dispatchEvent(new n(n.REMOVE_TOOLTIP,t)),this.dispatchEvent(new n(n.REMOVE_COMPONENT,t))):t.isType(r.COMMON)===!0&&(this.dispatchEvent(new n(n.REMOVE_COMMON,t)),this.dispatchEvent(new n(n.REMOVE_COMPONENT,t)))},i.prototype.restoreHookList=function(t,e){for(var n=0;n<e.length;n++){var r=e[n];if("setData"==r.action)t.setData(r.data,r.type);else if("addOperate"==r.action){var o=r.data;r.operate.unserialize(o),t.addOperate(r.operate)}}},Object.defineProperty(i.prototype,"sceneHistory",{get:function(){return t.typeSingleton("__UI_SCENE__",e)},enumerable:!0,configurable:!0}),i.prototype.runScene=function(t,e){is.truthy(this._sceneInst)&&this.remove(this._sceneInst,null,!1);var n=this.addScene(t,!0,e);return n},i.prototype.runTopScene=function(t,e){is.truthy(this._sceneInst)&&this.remove(this._sceneInst,null,!1);var n=this.addScene(t,!1,e);return n},i.prototype.addScene=function(e,o,i){this.sceneHistory.pushHistory(e,i,o);var a=this.getTypeInst(e,t.getSetting().SceneAnimation,i,r.SCENE);return t.display.setFullDisplay(a),this._sceneInst=a,o?this._scene.addChild(a):this._topScene.addChild(a),this._sceneInst.setHistoryComponent(!0),this._menu.visible=o,this.dispatchEvent(new n(n.RUN_SCENE,this._sceneInst)),this.dispatchEvent(new n(n.ADD_COMPONENT,this._sceneInst)),a},i.prototype.addCommon=function(e,o){var i=this.getTypeInst(e,null,o,r.COMMON);t.display.setFullDisplay(i),this._common.addChild(i),this.dispatchEvent(new n(n.ADD_COMMON,i)),this.dispatchEvent(new n(n.ADD_COMPONENT,i))},i.prototype.addTooltip=function(e,o){var i=this.getTypeInst(e,null,o,r.TOOLTIP);t.display.setFullDisplay(i),this._tooltip.addChild(i),egret.is(i,"meru.BaseComponent")&&(this.dispatchEvent(new n(n.ADD_TOOLTIP,i)),this.dispatchEvent(new n(n.ADD_COMPONENT,i)))},i.prototype.addGuide=function(e,o){var i=this.getTypeInst(e,null,o,r.GUIDE);return t.display.setFullDisplay(i),this._guide.addChild(i),this.dispatchEvent(new n(n.ADD_GUIDE,i)),this.dispatchEvent(new n(n.ADD_COMPONENT,i)),i},i.prototype.getContainerByType=function(t){switch(t){case r.BOX:return this._box;case r.SCENE:return this._scene;case r.GUIDE:return this._guide;case r.COMMON:return this._common;case r.MENU:return this._menu;case r.TOOLTIP:return this._tooltip;case r.PANEL:return this._panel}return null},i.prototype.hasPanel=function(){for(var t=this._panel,e=t.numChildren,n=0;e>n;n++){var r=t.getChildAt(n);if(r.visible)return!0}return!1},i.hasPanel=function(){return t.singleton(i).hasPanel()},i.prototype.getComponentByName=function(t,e){for(var n=e.numChildren,r=0;n>r;r++){var o=e.getChildAt(r);if(o.componentName==t)return o}return null},i.prototype.getComponent=function(e){var n=t.pullObject(t.k.GetComponent,e);if(null!=n&&n!=e)return n;for(var r=0;r<this._containerArr.length;r++){var o=this._containerArr[r],i=this.getComponentByName(e,o);if(i)return i}return null},i.prototype.isSingleContainer=function(t){return t.isType(r.SCENE)&&t.isType(r.MENU)?!0:!1},i.prototype.removeComponent=function(t){var e=this.getComponent(t);egret.is(e,"meru.BaseComponent")&&(this.isSingleContainer(e)||this.remove(e))},i.prototype.setMenu=function(e,o){null!=this._menuInst&&this.remove(this._menuInst);var i=this.getTypeInst(e,null,o,r.MENU);t.display.setFullDisplay(i),this._menuInst=i,this._menuInst.bottom=0,this._menu.addChild(this._menuInst),this.dispatchEvent(new n(n.SET_MENU,i)),this.dispatchEvent(new n(n.ADD_COMPONENT,i))},i.prototype.setRoot=function(t){t&&t.addChild(this)},i.runTopScene=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return t.singleton(i).runTopScene(e,n)},i.runScene=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return t.singleton(i).runScene(e,n)},i.setMenu=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];t.singleton(i).setMenu(e,n)},i.addCommon=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];t.singleton(i).addCommon(e,n)},i.injectionPanel=function(e,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];r.unshift(e),t.singleton(i).injectionPanel(e,n,r)},i.panelIsVisible=function(e){return t.singleton(i).panelIsDisplay(e)},i.prototype.showPanel=function(t,e){return is.string(t)&&t.indexOf("Skin")>-1||!is.string(t)?this._addPanel(t,e):this._showPanel(t,e)},i.showPanel=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return t.singleton(i).showPanel(e,n)},i.getComponent=function(e){return t.singleton(i).getComponent(e)},i.addBox=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return t.singleton(i).addBox(e,n)},i.addSequenceBox=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];t.singleton(i).addSequnceBox(e,"_normal_",-99999,n)},i.getSequenceCount=function(e){return t.singleton(i).getSequnceCount(e)},i.runGroupSequenceBox=function(e){t.singleton(i).runSequnceBox(e)},i.addGroupSequenceBox=function(e,n,r){for(var o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];t.singleton(i).addSequnceBox(e,n,r,o)},i.addGroupSequenceFun=function(e,n,r){t.singleton(i).addSequnceBox(null,n,r,[e],"fun")},i.addHistoryBox=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];t.singleton(i).addHistoryBox(e,n)},i.showHistoryPanel=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return t.singleton(i).showHistoryPanel(e,n)},i.addGuide=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return t.singleton(i).addGuide(e,n)},i.addEventListener=function(e,n,r){t.singleton(i).addEventListener(e,n,r)},i.once=function(e,n,r){t.singleton(i).once(e,n,r)},i.removeEventListener=function(e,n,r){t.singleton(i).removeEventListener(e,n,r)},i.addTooltip=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];t.singleton(i).addTooltip(e,n)},i.remove=function(e,n){void 0===n&&(n=null),t.singleton(i).remove(e,n)},i.clearBox=function(){t.singleton(i).clearBox()},i.getMenu=function(){var e=t.singleton(i)._menuInst;return e},i.getScene=function(){var e=t.singleton(i)._sceneInst;return e},i.getContainerByType=function(e){return t.singleton(i).getContainerByType(e)},i.hidePanel=function(e){t.singleton(i).hidePanel(e)},i.removeByName=function(e){t.singleton(i).removeComponent(e)},Object.defineProperty(i,"panelHistory",{get:function(){return t.singleton(i).panelHistory},enumerable:!0,configurable:!0}),i.setBoxVisible=function(e,n){void 0===n&&(n=null);for(var r=t.singleton(i),o=0,a=r._box.numChildren;a>o;o++)r._box.getChildAt(o)!=n&&(r._box.getChildAt(o).visible=e)},Object.defineProperty(i,"boxHistory",{get:function(){return t.singleton(i).boxHistory},enumerable:!0,configurable:!0}),Object.defineProperty(i,"sceneHistory",{get:function(){return t.singleton(i).sceneHistory},enumerable:!0,configurable:!0}),i.setRoot=function(e){t.singleton(i).setRoot(e)},i}(eui.UILayer);t.UI=o,__reflect(o.prototype,"meru.UI")}(meru||(meru={}));var meru;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._closeShowAll=!1,t}return __extends(n,e),Object.defineProperty(n.prototype,"closeShowAll",{get:function(){return this._closeShowAll},set:function(t){this._closeShowAll=t},enumerable:!0,configurable:!0}),n.prototype.onClose=function(){return!1},n.prototype.doClose=function(e){if(void 0===e&&(e=!1),1!=e){var n=this.onClose();if(n===!0)return}return this._closeShowAll&&!this.operatesIsComplete()?void this.setOperatesComplete():void t.display.removeFromParent(this)},n}(t.BaseComponent);t.BaseBox=e,__reflect(e.prototype,"meru.BaseBox")}(meru||(meru={}));var meru;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.closeVisible=!0,n.help="",n.title="",n.closeNotice="CLOSE_BOX",n.helpNotice="HELP_BOX",t.dependProperty(n,{help:"helpVisible",title:"titleVisible"}),n}return __extends(n,e),Object.defineProperty(n.prototype,"host",{get:function(){return this._host},set:function(t){this._host=t,this.helpBtn&&this.helpBtn.visible&&this.addToHost(this.helpBtn),this.closeBtn&&this.closeBtn.visible&&this.addToHost(this.closeBtn)},enumerable:!0,configurable:!0}),n.prototype.onEnter=function(){var e=t.display.findTypeParent(this,t.BaseBox);if(e)e.uiBottom=this,this.host=e;else{var n=t.display.findTypeParent(this,t.BaseComponent);this.host=n}this.setup(this.host)},n.prototype.setup=function(e){var n=this;e&&(e.doHelp=function(){if(n.helpVisible){var e=n.help.replace(".","_"),r=t.pullObject(e,null);t.$getCallback().on("help",n.help,r)}})},n.prototype.addToHost=function(e){var n=this,r=2,o=function(){if(!(r>0)){var o=n._host,i=o.getAnimationDisplay("box");if(i||(i=o),e.parent!=i){t.display.resetConstraint(e);var a=new egret.Matrix;a.copyFrom(e.$getConcatenatedMatrix()),e.$getConcatenatedMatrixAt(i,a),i.addChild(e),e.x=a.tx,e.y=a.ty}}};e.stage?r--:e.once(egret.Event.ADDED_TO_STAGE,function(){r--,o()},this),e.once(eui.UIEvent.MOVE,function(){r--,o()},this)},Object.defineProperty(n.prototype,"helpVisible",{get:function(){return is.truthy(this.help)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"titleVisible",{get:function(){return is.truthy(this.title)},enumerable:!0,configurable:!0}),n}(t.BaseComponent);t.UIBottom=e,__reflect(e.prototype,"meru.UIBottom")}(meru||(meru={}));var meru;!function(t){function e(e,n,r,o){var i=t.object.getValue(e,r,null);return null==i&&(i=t.object.getValue(n,r,o)),i}var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"c",{get:function(){return this._c},set:function(t){this._c=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"p",{get:function(){return this._p},set:function(t){this._p=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"host",{get:function(){return this._host},set:function(t){this._host=t},enumerable:!0,configurable:!0}),e.prototype.getProperty=function(t,e){return 0},e.prototype.update=function(){},e}(egret.EventDispatcher);t.SubModelCore=n,__reflect(n.prototype,"meru.SubModelCore");var r=function(t){function n(){return t.call(this)||this}return __extends(n,t),Object.defineProperty(n.prototype,"c",{get:function(){return this._core.c},set:function(t){this._core.c=t,this.onInitConfig()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"p",{get:function(){return this._core.p},set:function(t){this._core.p=t,this.onInitProxy()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"core",{get:function(){return this._core},set:function(t){this._core&&(t.p=this._core.p,t.c=this._core.c),this._core=t,t&&(t.host=this)},enumerable:!0,configurable:!0}),n.prototype.onInitConfig=function(){},n.prototype.onInitProxy=function(){},n.prototype.dispose=function(){},n.prototype.getValue=function(t,n){return void 0===n&&(n=null),e(this.p,this.c,t,n)},n}(egret.EventDispatcher);t.BaseSubModel=r,__reflect(r.prototype,"meru.BaseSubModel");var o=function(t){function n(){return t.call(this)||this}return __extends(n,t),Object.defineProperty(n.prototype,"c",{get:function(){return this._configData},set:function(t){this._configData=t,this.onInitConfig()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"p",{get:function(){return this._proxyData},set:function(t){this._proxyData=t,this.onInitProxy()},enumerable:!0,configurable:!0}),n.prototype.onInitProxy=function(){},n.prototype.onInitConfig=function(){},n.prototype.dispose=function(){},n.prototype.getValue=function(t,n){return void 0===n&&(n=null),e(this.p,this.c,t,n)},n}(egret.EventDispatcher);t.BaseModel=o,__reflect(o.prototype,"meru.BaseModel")}(meru||(meru={}));var meru;!function(t){var e=function(){function e(){this._confMap={}}return e.prototype.getConfig=function(e,n,r){if(!this._confMap.hasOwnProperty(e)){var o=RES.getRes(e);o&&(this._confMap[e]=o)}if(null==n)return this._confMap[e]||r;var i=r;return this._confMap.hasOwnProperty(e)&&null!=n&&(i=t.object.getValue(this._confMap[e],n,r)),i},e.prototype.exists=function(e,n){if(!this._confMap.hasOwnProperty(e)){var r=RES.getRes(e);r&&(this._confMap[e]=r)}return this._confMap.hasOwnProperty(e)&&t.object.hasValue(this._confMap[e],n)?!0:!1},e.exists=function(n,r){return t.singleton(e).exists(n,r)},e.get=function(n,r,o){return void 0===r&&(r=null),void 0===o&&(o=null),t.singleton(e).getConfig(n,r,o)},e}();t.Config=e,__reflect(e.prototype,"meru.Config")}(meru||(meru={}));var meru;!function(t){var e=function(e){function n(t,n){var r=e.call(this,t)||this;return r._info=n,r}return __extends(n,e),n.prototype.getNewModel=function(e,n){var r=this._info.factory(n),o=new this._info.type;return o instanceof t.BaseSubModel&&this._info.subCoreFactory&&(o.core=this._info.subCoreFactory(n)),o.c=r,o},n.prototype.getModel=function(n){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];for(var i=[],a=0;a<r.length;a++){var s=r[a];if(!this.has(s)){var u=this._info.factory(s),c=new this._info.type;c instanceof t.BaseSubModel&&this._info.subCoreFactory&&(c.core=this._info.subCoreFactory(s)),c.c=u,this.onAdd(c)}i=i.concat(e.prototype.getModel.call(this,n,s))}return i},n}(t.DataStore);t.ConfigDataStore=e,__reflect(e.prototype,"meru.ConfigDataStore")}(meru||(meru={}));var meru;!function(t){var e=function(){function e(e){this._dataStoreMap={},this._deleteModels=[],this._addModels=[],this._type=e,this._info=e.info,this._info.type=e,this._mainStore=new t.MainDataStore(this._info.autoKey),this._info.confKey&&(this._aliasKey=t.data.DataUtils.formatAliasKey(this._info.confKey),this._dataStoreMap[this._aliasKey.configKey]=new t.ConfigDataStore(this._aliasKey.configKey,this._info));for(var n=0;n<this._info.otherKeys.length;n++){var r=this._info.otherKeys[n];this._dataStoreMap[r]=new t.DataStore(r)}t.addNotification(t.k.BeforeChange(this._info.moddo),this.onBeforeChange,this),t.addNotification(t.k.Change(this._info.moddo),this.onAfterChange,this),t.addNotification(t.k.Cache(this._info.moddo),this.onCacheData,this)}return e.prototype.getList=function(){return this._mainStore.getList()},e.prototype.getStore=function(t){if(t==this._info.autoKey)return this._mainStore;if(this._dataStoreMap.hasOwnProperty(t)){var e=this._dataStoreMap[t];return e}return null},e.prototype.get=function(t,e){var n=this.getStore(t);return n?n.getModel(t,e):[]},e.prototype.getMultiple=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.getStore(t);return r?r.getModel.apply(r,[t].concat(e)):[]},e.prototype.deleteModel=function(e){t.object.setValue(e,"p.num",0),this._mainStore.onDelete(e),egret.callLater(function(){e.p=null},this);for(var n in this._dataStoreMap)if(n!=this._aliasKey.configKey||this._info.isMultiple){var r=this._dataStoreMap[n];r.onDelete(e)}},e.prototype.updateModel=function(t,e){this._dataStoreMap.hasOwnProperty(t)&&this._dataStoreMap[t].update(e)},e.prototype.getModel=function(e){var n=this._info.confKey,r=t.data.DataUtils.formatAliasKey(n),o=t.object.getValue(e,r.proxyKey,null),i=null;if(null!=o)if(this._info.isMultiple)i=this._dataStoreMap[r.configKey].getNewModel(r.configKey,o);else{var a=this._dataStoreMap[r.configKey].getModel(r.configKey,o);null!=a&&a.length>0&&(i=a[0])}return null==i&&(i=new this._info.type),i.p=e,i},e.prototype.addModules=function(t){var e=this;t.forEach(function(t){var n=e.getModel(t);e._addModels.push(n),e._mainStore.onAdd(n);for(var r in e._dataStoreMap){var o=e._dataStoreMap[r];o.onAdd(n)}})},e.prototype.add=function(t){this.addModules(t)},e.prototype["delete"]=function(t){var e=t.split("_");if(e[1]==this._info.autoKey)for(var n=e[2].replace("@",""),r=this._mainStore.getModel(this._info.autoKey,n),o=0;o<r.length;o++){var i=r[o];this._deleteModels.push(i),this.deleteModel(i)}},e.prototype.find=function(e,n){var r=e.split("_");if(r[1]==this._info.autoKey){var o=r[2].replace("@",""),i=this._mainStore.getModel(this._info.autoKey,o);for(var a in n)if(a.indexOf("@s")>-1){var s=a.split("."),u=s[1];if(this._dataStoreMap.hasOwnProperty(u))for(var c=0;c<i.length;c++){var h=i[c];this.updateModel(u,h)}t.postNotification(t.k.UPDATE_MODEL(this._info.type,u),i[0]),"num"==u&&this.updateNum(i[0])}}},e.prototype.updateNum=function(e){t.postNotification(t.k.UPDATE_NUM(this._info.type),e)},e.prototype.onChangeData=function(t,e){this._deleteModels.length=0,this._addModels.length=0;for(var n in t[this._info.listKey])"@a"==n&&"after"==e?this.add(t[this._info.listKey][n]):n.indexOf("@d")>-1&&"before"==e?this["delete"](n):n.indexOf("@f")>-1&&"after"==e&&this.find(n,t[this._info.listKey][n]);this.postChangeModel()},e.prototype.postChangeModel=function(){if(this._addModels.length>0){t.postNotification(t.k.ADD_MODEL(this._info.type),this._addModels);for(var e=0;e<this._addModels.length;e++)this.updateNum(this._addModels[e])}if(this._deleteModels.length>0){t.postNotification(t.k.DELETE_MODEL(this._info.type),this._deleteModels);for(var e=0;e<this._deleteModels.length;e++)this.updateNum(this._deleteModels[e])}},e.prototype.onBeforeChange=function(t){this.onChangeData(t,"before")},e.prototype.onAfterChange=function(t){this.onChangeData(t,"after")},e.prototype.onCacheData=function(t){this.addModules(t[this._info.listKey])},e}();t.Data=e,__reflect(e.prototype,"meru.Data")}(meru||(meru={}));var meru;!function(t){function e(t,e,n){return i.get(t,e,n)}function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return i.getMultiple.apply(i,[t,e].concat(n))}function r(t){i.injectionModel(t)}function o(t){return i.getList(t)}var i=function(){function e(){}return e.getData=function(e){var n=t.getTypeId(e);return this._dataMap.hasOwnProperty(n)||(this._dataMap[n]=new t.Data(e)),this._dataMap[n]},e.injectionModel=function(e){var n=t.getTypeId(e);this._dataMap.hasOwnProperty(n)||(this._dataMap[n]=new t.Data(e))},e.get=function(t,e,n){var r=this.getData(t).get(e,n);return null!=r&&r.length>0?r[0]:null},e.getMultiple=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=(i=this.getData(t)).getMultiple.apply(i,[e].concat(n));return null==o&&(o=[]),o;var i},e.getList=function(t){return this.getData(t).getList()},e._dataMap={},e}();t.DataCenter=i,__reflect(i.prototype,"meru.DataCenter"),t.getModel=e,t.getMultipleModel=n,t.injectionModel=r,t.unknown="unknown",t.getModelList=o}(meru||(meru={}));var meru;!function(t){var e,n=eui.PropertyEvent;!function(t){t[t.enter=0]="enter",t[t.exit=1]="exit"}(e=t.OperateState||(t.OperateState={}));var r=function(r){function o(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var i=r.call(this)||this;return i.$_componentState=e.exit,i.$_stateEnum=0,i._isFull=!1,i._dataMapArr=[],i._operates=[],i._isHistoryComponent=!1,i.$_state=new t.ComponentState(i),i.addEventListener(egret.Event.COMPLETE,i.onLoaded,i),i.setArgs(n),i}return __extends(o,r),o.prototype.clearListeners=function(){this.$_state.clearLiteners()},Object.defineProperty(o.prototype,"hook",{get:function(){return this._hook},set:function(t){this._hook=t},enumerable:!0,configurable:!0}),o.prototype.setManual=function(t){t&&(this.$_stateEnum^=1)},Object.defineProperty(o.prototype,"autoId",{get:function(){return this.$_data?this.$_data.autoId:""},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"componentState",{get:function(){return this.$_componentState},enumerable:!0,configurable:!0}),o.prototype.setArgs=function(t){this.$_stateEnum|=1,this.$_state.setArgs(t),this.pullData()},o.prototype.updateAttribute=function(t){this[t.name]=t.value},o.prototype.pullData=function(){if((1&this.$_stateEnum)>0&&(2&this.$_stateEnum)>0){var e=this.$_state.getArgs();e=[this.skinName].concat(e);var n=t.pullObject.apply(t,["getSkinData"].concat(e));n&&n!=this.skinName&&(this.data=n);var r=t.getStruct("VARIABLE");r&&r.data&&(this.variable=r.data)}},o.prototype.onLoaded=function(){this.$_stateEnum|=2,this.pullData()},o.prototype.addDataMap=function(t){-1==this._dataMapArr.indexOf(t)&&this._dataMapArr.push(t)},Object.defineProperty(o.prototype,"data",{get:function(){return this.$_data},set:function(t){this.$_data=t,null!=t&&(this.addDataMap("data"),n.dispatchPropertyEvent(this,n.PROPERTY_CHANGE,"data")),this.dataChanged()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"variable",{get:function(){return this.$_vip},set:function(t){this.$_vip=t,null!=t&&(this.addDataMap("variable"),n.dispatchPropertyEvent(this,n.PROPERTY_CHANGE,"variable"))},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isFull",{get:function(){return this._isFull},enumerable:!0,configurable:!0}),o.prototype.setFull=function(){return this._isFull=!0,this},o.prototype.setData=function(t,e){return void 0===e&&(e="data"),"data"==e?(this.data=t,null!=t&&this.addDataMap("data")):(this[e]=t,null!=t&&(this.addDataMap(e),n.dispatchPropertyEvent(this,n.PROPERTY_CHANGE,e))),this._hook&&null!=t&&this._hook.setData(t,e),this},o.prototype.addOperate=function(t){return this.$_componentState==e.enter?(t.state=e.enter,t.enter(this)):t.state=e.exit,this._hook&&this._hook.addOperate(t),this._operates.push(t),this},o.prototype.removeOperate=function(t){var n=this._operates.indexOf(t);n>-1&&(t.state=e.exit,t.exit(this),this._operates.splice(n,1))},o.prototype.setState=function(t){return this.currentState=t,this},o.prototype.setCompName=function(t){return this.componentName=t,this},o.prototype.clearOperate=function(){for(;this._operates.length>0;)this.removeOperate(this._operates[0])},o.prototype.removeOperateByName=function(t){for(var e=this._operates.length-1;e>=0;e--)this._operates[e].getName()==t&&this.removeOperate(this._operates[e])},o.prototype.getOperateByName=function(t){for(var e=[],n=0;n<this._operates.length;n++)this._operates[n].getName()==t&&e.push(this._operates[n]);return e},o.prototype.getOperateByType=function(t){for(var e=[],n=0;n<this._operates.length;n++)this._operates[n].type==t&&e.push(this._operates[n]);return e},o.prototype.operatesIsComplete=function(){return this._operates.every(function(t){return t.isComplete})},o.prototype.setOperatesComplete=function(){this._operates.forEach(function(t){return t.setComplete()})},o.prototype.dataChanged=function(){},Object.defineProperty(o.prototype,"animation",{get:function(){return this.$_anim},set:function(t){this.$_anim=t,t&&(this.$_anim.component=this)},enumerable:!0,configurable:!0}),o.prototype.isType=function(e){return e==t.UIType.ANY?this._type>t.UIType.MIN&&this._type<t.UIType.ANY:this._type==e},o.prototype.setType=function(t){this._type=t},o.prototype.isHistoryComponent=function(){return this._isHistoryComponent},o.prototype.listener=function(t,e){this.$_state.listener(t,e)},o.prototype.setHistoryComponent=function(t){this._isHistoryComponent=t},Object.defineProperty(o.prototype,"componentName",{get:function(){return this._componentName},set:function(t){this._componentName=t},enumerable:!0,configurable:!0}),o.prototype.getAnimationDisplay=function(t){return""==t?this:is.falsy(t)?this:"box"==t?this.getSubview("boxGroup")||this.getSubview("uiGroup"):"mask"==t?this.getSubview("maskRect"):this.getSubview(t)},o.prototype.getSubview=function(t){return this[t]?this[t]:this.getChildByName(t)},o.prototype.onEnter=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];this.$_componentState=e.enter,t.display.setAttribute(this);for(var o=0;o<this._operates.length;o++)this._operates[o].state=e.enter,this._operates[o].enter(this)},o.prototype.destoryData=function(){for(;this._dataMapArr.length;)this[this._dataMapArr.shift()]=null;t.display.destoryChildren(this)},o.prototype.onExit=function(){this.$_componentState=e.exit;for(var t=0;t<this._operates.length;t++)this._operates[t].state=e.exit,this._operates[t].exit(this)},o}(eui.Component);t.isBaseComponent=r,__reflect(r.prototype,"meru.isBaseComponent",["meru.IUIAnimationComponent","meru.IComponent","egret.DisplayObject","meru.IAttributeHost"])}(meru||(meru={}));var meru;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onItemTap,e),e}return __extends(e,t),e.prototype.onItemTap=function(){},e}(eui.ItemRenderer);t.BaseItemRenderer=e,__reflect(e.prototype,"meru.BaseItemRenderer")}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){this._spid=egret.getOption("egret.runtime.spid"),this._platform=egret.getOption("pf")||"bearjoy",this._bench=egret.getOption("gv")||"local",this._version=egret.getOption("fv"),this._oplayerId=egret.getOption("oplayerId"),this._channel=egret.getOption("channelTag"),this._runtime=egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE}return Object.defineProperty(t.prototype,"runtime",{get:function(){return this._runtime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"channel",{get:function(){return this._channel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spId",{get:function(){return this._spid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"platform",{get:function(){return this._platform},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bench",{get:function(){return this._bench},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"oplayerId",{get:function(){return this._oplayerId},enumerable:!0,configurable:!0}),t}();t.ExtraInfo=e,__reflect(e.prototype,"meru.ExtraInfo");var n=null;t.def(t,"extra",function(){return n||(n=new e),n})}(meru||(meru={}));var meru;!function(t){var e=function(){function e(){}return e.getType=function(){var e=t.getSetting().ItemModelClass,n=t.getDefinitionType(e,null);return n?n:null},e.getName=function(e){var n=this.getType();if(n){var r=n.NameKey?n.NameKey:"name",o=n.info.confKey,i=t.data.DataUtils.formatAliasKey(o),a=t.getModel(n,i.configKey,e);if(a&&a.c)return t.object.getValue(a.c,r,null)}return null},e.getNum=function(e){var n=this.getType();if(n){var r=n.NumKey?n.NumKey:"num",o=n.info.confKey,i=t.data.DataUtils.formatAliasKey(o),a=t.getModel(n,i.configKey,e);if(a&&a.p)return t.object.getValue(a.p,r,0)}return 0},e.getItemByConfigId=function(e){var n=this.getType();if(n){var r=n.info.confKey,o=t.data.DataUtils.formatAliasKey(r),i=t.getModel(n,o.configKey,e);return i}return null},e.getItemByAutoId=function(e){var n=this.getType();if(n){var r=n.info.autoKey,o=t.getModel(n,r,e);return o}return null},e.getItems=function(){var e=this.getType();return e?t.getModelList(e):[]},e.getItemsByKey=function(e,n){var r=this.getType();return r?t.getMultipleModel(r,e,n):[]},e}();t.item=e,__reflect(e.prototype,"meru.item")}(meru||(meru={}));var meru;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._list=[],t}return __extends(n,e),n.prototype.onAdd=function(t){e.prototype.onAdd.call(this,t),this._list.push(t)},n.prototype.onDelete=function(n){e.prototype.onDelete.call(this,n),t.array.remove(this._list,n)},n.prototype.getList=function(){return this._list},n}(t.DataStore);t.MainDataStore=e,__reflect(e.prototype,"meru.MainDataStore")}(meru||(meru={}));var meru;!function(t){var e=function(){function t(t,e,n,r,o,i,a,s){void 0===a&&(a=null),void 0===s&&(s=!1),this._isMultiple=!1,this._moddo=t,this._autoKey=e,this._isMultiple=s,this._factory=i,this._listKey=o,this._subCoreFactory=a,this._confKey=n,this._otherKeys=r}return Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMultiple",{get:function(){return this._isMultiple},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"otherKeys",{get:function(){return this._otherKeys},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"confKey",{get:function(){return this._confKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoKey",{get:function(){return this._autoKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listKey",{get:function(){return this._listKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subCoreFactory",{get:function(){return this._subCoreFactory},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"factory",{get:function(){return this._factory},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"moddo",{get:function(){return this._moddo},enumerable:!0,configurable:!0}),t}();t.ModelInfo=e,__reflect(e.prototype,"meru.ModelInfo")}(meru||(meru={}));var meru;!function(t){var e=function(){function e(){}return e.getModDo=function(t){return is.string(t)?t:t&&t.moddo?t.moddo:null},e.BeforeChange=function(t){return"BeforeChange."+e.getModDo(t)},e.AfterChange=function(t){return"AfterChange."+e.getModDo(t)},e.Change=function(t){return"Change."+e.getModDo(t)},e.Cache=function(t){return"Cache."+e.getModDo(t)},e.ADD_MODEL=function(e){return"ADD_MODEL_"+t.getTypeId(e)},e.DELETE_MODEL=function(e){return"DELETE_MODEL_"+t.getTypeId(e)},e.UPDATE_MODEL=function(e,n){return"UPDATE_MODEL_"+t.getTypeId(e)+"_"+n},e.UPDATE_NUM=function(e){return"UPDATE_"+t.getTypeId(e)+"_NUM"},e.All=function(t){return"All."+e.getModDo(t)},e.ResponseSucceed="proxy_response_succeed",e.StatusWait="proxy_status_wait",e.StatusResponse="proxy_status_response",e.RequestError="proxy_request_error",e.ResponseError="proxy_response_error",e.GetComponent="get_component",e.MultiResponseError="multiproxy_response_error",e.SKIP_MUTATION="skip_mutation",e.GET_BUTTON="guide_get_button",e.CLICK_BUTTON="guide_click_button",e.UserLvUp="UserLevelUp",e.TencentLogin="TencentLogin",e.CacheChange="CacheChange",e}();t.NotificationKey=e,__reflect(e.prototype,"meru.NotificationKey"),t.k=e}(meru||(meru={}));var meru;!function(t){function e(){return t.singleton(r)}function n(e){e.once(egret.Event.ADDED_TO_STAGE,function(){var e=egret.Capabilities.isMobile?egret.StageScaleMode.FIXED_WIDTH:egret.StageScaleMode.SHOW_ALL;t.stage.scaleMode=e},this)}var r=function(){function e(){}return e.prototype.getAnimation=function(t){return t?t:"NoneAnimation"},Object.defineProperty(e.prototype,"SimpleLoadingClass",{get:function(){return this._setting.SimpleLoadingClass},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LoadSceneClass",{get:function(){return this._setting.LoadSceneClass},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TooltipClass",{get:function(){return this._setting.TooltipClass},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AnimationBlueprint",{get:function(){return this._setting.AnimationBlueprint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ProgressLoadingClass",{get:function(){return this._setting.ProgressLoadingClass},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GameCallbackClass",{get:function(){return this._setting.GameCallbackClass},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BoxClass",{get:function(){return this._setting.BoxClass},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ConfirmClass",{get:function(){return this._setting.ConfirmClass
},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SceneAnimation",{get:function(){return this.getAnimation(this._setting.SceneAnimation)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PanelAnimation",{get:function(){return this.getAnimation(this._setting.PanelAnimation)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ItemModelClass",{get:function(){return this._setting.ItemModelClass},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BoxAnimation",{get:function(){return this.getAnimation(this._setting.BoxAnimation)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ProjectName",{get:function(){return this._setting.ProjectName},enumerable:!0,configurable:!0}),e.prototype.init=function(e){this._setting=e,t.localStorage.setPrefix(this._setting.ProjectName+"-"+t.extra.spId)},e.init=function(n){var r=t.object.getValue(n,"GameConfig");t.singleton(e).init(r);var o=t.object.getValue(n,"Modules");for(var i in o){var a=o[i],s=a.Setting;if(s){var u=egret.getDefinitionByName(s);u&&u.init(a.Property)}}},e}();t.Setting=r,__reflect(r.prototype,"meru.Setting",["meru.ISetting"]),t.getSetting=e,t.setup=n}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){}return t.remove=function(t,e){var n=!1;if(is.fun(e))for(var r=e,o=t.length-1;o>=0;o--)r(t[o])&&(t.splice(o,1),n=!0);else if(is.truthy(e))for(var i=[].concat(e),o=0;o<i.length;o++){var a=t.indexOf(i[o]);a>-1&&(t.splice(a,1),n=!0)}return n},t.shuffle=function(t){return t.sort(function(){var t=Math.random();return t>.5?1:-1})},t.pluck=function(t,e){return t.map(function(t){return t[e]})},t.compact=function(t){return t.filter(function(t){return t})},t.range=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=1),0==e&&(e=t||0,t=0),1==n&&(n=t>e?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),o=Array(r),i=0;r>i;i++,t+=n)o[i]=t;return o},t.find=function(t,e,n){void 0===n&&(n=null);for(var r=0;r<t.length;r++){var o=t[r];if(e&&e.call(n,o))return o}return null},t.where=function(t,e){for(var n=Object.keys(e),r=[],o=0;o<t.length;o++){var i=t[o],a=n.every(function(t){return i[t]==e[t]});a&&r.push(i)}return r},t.findWhere=function(e,n){var r=t.where(e,n);return r.length>0?r[0]:null},t.contains=function(t,e){if(is.fun(e)){var n=e,r=t.some(n);return r}var o=t.indexOf(e);return o>-1?!0:!1},t}();t.array=e,__reflect(e.prototype,"meru.array")}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){}return t.parseColorText=function(t){return t=t.replace(/\s{0,1}\#([a-zA-Z0-9]+)/,function(t,e){var n=e;return e[e]&&(n=e[e]),'<font color="'+n+'">'}),t=t.replace(/\s\#\s*/,function(t){return"</font>"})},t.html=function(t){return this.parseColorText(t)},t.red=16711680,t.white=16777215,t.black=0,t}();t.color=e,__reflect(e.prototype,"meru.color")}(meru||(meru={}));var meru;!function(t){var e=function(){function e(){}return e.setAnchor=function(t,e,n){void 0===n&&(n=e),t.anchorOffsetX=t.width*e,t.anchorOffsetY=t.height*n},e.isHostComponentType=function(e){return e instanceof t.BaseComponent||e instanceof t.ItemRenderer},Object.defineProperty(e,"stageW",{get:function(){return t.stage.stageWidth},enumerable:!0,configurable:!0}),e.fixedToCenter=function(t,e,n,r){void 0===n&&(n=t.viewport.measuredWidth),void 0===r&&(r=t.viewport.measuredHeight),egret.callLater(function(){t.viewport.scrollV=e.y-t.height/2+e.height/2,t.viewport.scrollV<0?t.viewport.scrollV=0:t.viewport.scrollV>r-t.height&&(t.viewport.scrollV=r-t.height),t.viewport.scrollH=e.x-t.width/2+e.width/2,t.viewport.scrollH<0?t.viewport.scrollH=0:t.viewport.scrollH>n-t.width&&(t.viewport.scrollH=n-t.width)},this)},e.pointInScreen=function(t,e,n){var r=t.localToGlobal(e,n);return r.x>0&&r.y>0&&r.x<this.stageW&&r.y<this.stageH},e.inScreen=function(e){var n=e.getTransformedBounds(t.stage),r=this.stageW,o=this.stageH;return n.x>=-n.width&&n.x<=r&&n.y>=-n.height&&n.y<=o},Object.defineProperty(e,"stageH",{get:function(){return t.stage.stageHeight},enumerable:!0,configurable:!0}),e.setFullDisplay=function(t){t.width=this.stageW,t.height=this.stageH},e.getStagePosition=function(t,e){void 0===e&&(e=t);var n=this.stageW*t,r=this.stageH*e;return{x:n,y:r}},e.isVisible=function(e){for(;e.parent&&e.visible;)e=e.parent;return e==t.stage||e.visible?!0:!1},e.setPositionFromStage=function(t,e,n){void 0===e&&(e=.5),void 0===n&&(n=e);var r=this.getStagePosition(e,n);t.x=r.x,t.y=r.y},e.sort=function(t){for(var e=t.numChildren,n=[],r=0;e>r;r++)n.push(t.getChildAt(r));n.sort(function(t,e){return t.y-e.y}),n.forEach(function(e,n){t.setChildIndex(e,n)})},e.createBitmap=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=e);var r=new egret.Bitmap;if(is.truthy(t)){var o=RES.getRes(t);o?(r.texture=o,r.anchorOffsetX=r.width*e,r.anchorOffsetY=r.height*e):RES.getResAsync(t,function(){o=RES.getRes(t),r.texture=o,r.anchorOffsetX=r.width*e,r.anchorOffsetY=r.height*e},this)}return r},e.setAttribute=function(e){for(var n=e.numChildren,r=n-1;r>=0;r--){var o=e.getChildAt(r);if(o instanceof t.Attribute){var i=o;e[i.name]=i.value}}},e.addToContianer=function(t,e){var n=this.localTolocal(t.x,t.y,t.parent,e);this.resetConstraint(t),t.x=n.x,t.y=n.y,e.addChild(t)},e.resetConstraint=function(t){egret.is(t,"eui.Component")&&(t.left=t.right=t.top=t.bottom=t.horizontalCenter=t.verticalCenter=0/0)},e.findTypeParent=function(t,e){for(var n=t.parent;n;){if(n instanceof e)return n;n=n.parent}return null},e.getHostComponent=function(t){var e=t.parent;if(this.isHostComponentType(e))return e;for(;e&&!this.isHostComponentType(e);)e=e.parent;return this.isHostComponentType(e)?e:null},e.removeAllChildren=function(t){for(;t.numChildren>0;)t.removeChildAt(0)},e.localTolocal=function(t,e,n,r,o){return void 0===o&&(o=new egret.Point(t,e)),o=n.localToGlobal(t,e,o),o=r.globalToLocal(o.x,o.y,o)},e.getScale=function(t){for(var e={x:t.scaleX,y:t.scaleY};t.parent;)t=t.parent,e.x*=t.scaleX,e.y*=t.scaleY;return e},e.destoryChildren=function(e){for(var n=e.numChildren,r=0;n>r;r++){var o=e.getChildAt(r);o instanceof t.BaseComponent?o.destoryData():o instanceof t.Button?o.destoryData():o instanceof eui.Group?this.destoryChildren(o):o instanceof eui.Scroller?this.destoryChildren(o):o instanceof t.ItemRenderer&&o.destoryData()}},e.removeFromParent=function(e,n){void 0===n&&(n=!1),!n&&egret.is(e,"meru.BaseComponent")?t.UI.remove(e):is.truthy(e)&&e.parent&&e.parent.removeChild(e)},e}();t.display=e,__reflect(e.prototype,"meru.display")}(meru||(meru={}));var ___math___=Math,meru;!function(t){var e=function(){function t(){}return t.roundAwayFromZero=function(t){return t>0?___math___.ceil(t):___math___.floor(t)},t}();t.math=e,__reflect(e.prototype,"meru.math")}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){}return t.randInt=function(t,e){return ___math___.floor(___math___.random()*(e-t+1))+t},t.randFloat=function(t,e){return ___math___.random()*(e-t)+t},t.padNum=function(t,e){var n=t.toString(),r=e.length-n.length;return r>0?"0"+n:n},t.toCountdown=function(t,e){var n=this,r=Math.floor(t/86400);t%=86400;var o=Math.floor(t/3600);t%=3600;var i=Math.floor(t/60);t%=60;var a=Math.floor(t),s=e.replace(/((\[)(.*?))?(D{1,2})(([^\]]?)\])?/gi,function(t,e,o,i,a,s,u){return"["==o&&0>=r?"":(i||"")+n.padNum(r,a)+(u||"")});return s=s.replace(/((\[)(.*?))?(H{1,2})(([^\]]?)\])?/gi,function(t,e,r,i,a,s,u){return"["==r&&0>=o?"":(i||"")+n.padNum(o,a)+(u||"")}),s=s.replace(/((\[)(.*?))?(M{1,2})(([^\]]?)\])?/gi,function(t,e,r,a,s,u,c){return"["==r&&0>=o&&0>=i?"":(a||"")+n.padNum(i,s)+(c||"")}),s=s.replace(/((\[)(.*?))?(S{1,2})(([^\]]?)\])?/gi,function(t,e,r,i,s,u,c){return"["==r&&o>0?"":(i||"")+n.padNum(a,s)+(c||"")})},t}();t.num=e,__reflect(e.prototype,"meru.num")}(meru||(meru={}));var meru;!function(t){function e(e,n,r){return void 0===r&&(r=null),t.object.getValue(e,n,r)}var n=function(){function t(){}return t.clone=function(t){var e=this;if(is.falsy(t)||is.not.object(t))return t;if(t instanceof RegExp)return t;var n=Array.isArray(t)?[]:{};return Object.keys(t).forEach(function(r){is.object(t[r])?n[r]=e.clone(t[r]):n[r]=t[r]}),n},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e},t.values=function(t){for(var e=this.keys(t),n=e.length,r=Array(n),o=0;n>o;o++)r[o]=t[e[o]];return r},t.isMatch=function(t,e){var n=this.keys(e),r=n.length;if(null==t)return!r;for(var o=Object(t),i=0;r>i;i++){var a=n[i];if(e[a]!==o[a]||!(a in o))return!1}return!0},t.matches=function(t){var e=this;return function(n){return e.isMatch(n,t)}},t.hasValue=function(t,e){if(!t)return!1;e+="";for(var n=e.split("."),r=t;n.length>0&&r;){var o=n.shift();if(!r.hasOwnProperty(o))return!1;r=r[o]}return!0},t.setValue=function(t,e,n,r){if(void 0===r&&(r=!1),!is.falsy(t)){e+="";for(var o=e.split("."),i=t,a=0;a<o.length-1&&(e=o[a],i=is.array(i)?i[parseInt(e)]:i[e],!is.falsy(i));a++);if(is.truthy(i)){var s=o[o.length-1];r?i[s]=n:i.hasOwnProperty(s)&&(i[s]=n)}}},t.getValue=function(t,e,n){if(void 0===n&&(n=null),is.falsy(t))return n;e+="";for(var r=e.split("."),o=t,i=0;i<r.length;i++){var e=r[i];if(o=is.array(o)?o[parseInt(e)]:""==e?o:o[e],is.not.existy(o))break}return is.not.existy(o)?n:o},t.deepClone=function(t){var e=this;if(is.falsy(t)||is.not.object(t))return t;var n=Array.isArray(t)?[]:{};return Object.getOwnPropertyNames(t).forEach(function(r){is.object(t[r])?n[r]=e.deepClone(t[r]):n[r]=t[r]}),n},t.assign=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.forEach(function(e){return Object.keys(e).forEach(function(n){return t[n]=e[n]})}),t},t.toObject=function(t,e,n){var r=this;return void 0===n&&(n=function(t){return t}),t.reduce(function(t,o){return r.assign(t,(i={},i[e(o)]=n(o),i));var i},Object.create(null))},t.equals=function(t,e){if(t===e)return!0;if(null===t||void 0===t||null===e||void 0===e)return!1;if(typeof t!=typeof e)return!1;if("object"!=typeof t)return!1;if(Array.isArray(t)!==Array.isArray(e))return!1;var n,r;if(Array.isArray(t)){if(t.length!==e.length)return!1;for(n=0;n<t.length;n++)if(!this.equals(t[n],e[n]))return!1}else{var o=[];for(r in t)o.push(r);o.sort();var i=[];for(r in e)i.push(r);if(i.sort(),!this.equals(o,i))return!1;for(n=0;n<o.length;n++)if(!this.equals(t[o[n]],e[o[n]]))return!1}return!0},t}();t.object=n,__reflect(n.prototype,"meru.object"),t.v=e}(meru||(meru={}));var meru;!function(t){var e;!function(t){t[t.LEFT=0]="LEFT",t[t.MIDDLE=1]="MIDDLE",t[t.RIGHT=2]="RIGHT"}(e=t.PadDireciton||(t.PadDireciton={}));var n=function(){function n(){}return n.pad=function(t,n,r,o){void 0===n&&(n=0),void 0===r&&(r=" "),void 0===o&&(o=e.MIDDLE);var i=0;if(n+1>=t.length)switch(o){case e.LEFT:t=new Array(n+1-t.length).join(r)+t;break;case e.MIDDLE:var a=Math.ceil((i=n-t.length)/2),s=i-a;t=new Array(s+1).join(r)+t+new Array(a+1).join(r);break;default:t+=new Array(n+1-t.length).join(r)}return t},n.replaceFromObject=function(e,n){if(is.object(n))for(var r in n)e=t.str.replaceAll(e,"{"+r+"}",n[r]);return e},n.format=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return 0==e.length?t:t.replace(this._formatRegexp,function(t,n){var r=parseInt(n,10);return isNaN(r)||0>r||r>=e.length?t:e[r]})},n.formatFromObject=function(t,e){return is.falsy(e)||is.empty(e)?t:t.replace(this._formatObjRegexp,function(t,n){return e.hasOwnProperty(n)?e[n]:t})},n.trim=function(t,e){void 0===e&&(e=" ");var n=this.ltrim(t,e);return this.rtrim(n,e)},n.ltrim=function(t,e){if(!t||!e)return t;var n=e.length;if(0===n||0===t.length)return t;for(var r=0,o=-1;(o=t.indexOf(e,r))===r;)r+=n;return t.substring(r)},n.rtrim=function(t,e){if(!t||!e)return t;var n=e.length,r=t.length;if(0===n||0===r)return t;for(var o=r,i=-1;;){if(i=t.lastIndexOf(e,o-1),-1===i||i+n!==o)break;if(0===i)return"";o=i}return t.substring(0,o)},n.startsWith=function(t,e){if(t.length<e.length)return!1;for(var n=0;n<e.length;n++)if(t[n]!==e[n])return!1;return!0},n.endsWith=function(t,e){var n=t.length-e.length;return n>0?t.lastIndexOf(e)===n:0===n?t===e:!1},n.replaceAll=function(t,e,n){var r=t.replace(new RegExp(e,"g"),n);return r},n.formatNotice=function(e){var n=e.replace(/\#([^\#]+)\#/,function(e,n){var r=t.pullObject(n);return r?r:n});return n},n.repeat=function(t,e){for(var n=new Array(e),r=0;e>r;r++)n[r]=t;return n.join("")},n._formatRegexp=/{(\d+)}/g,n._formatObjRegexp=/{([^\}]+)}/g,n}();t.str=n,__reflect(n.prototype,"meru.str")}(meru||(meru={}));var meru;!function(t){var e=function(){function e(t,e,n){this.params=[],this.name=t,this.property=e,this.generate=n}return e.prototype.addParams=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.params=this.params.concat(t)},e.prototype.check=function(e){if(null==this.property)return!0;var n=t.object.getValue(e,this.property);return this.params.indexOf(n)>-1},e.prototype.getList=function(t){var e=this,n=null;return"all"==this.name?(n=this.generate(),t.length>0&&(n=n.filter(function(e){return-1==t.indexOf(e)}))):n=this.params.reduce(function(n,r){var o=e.generate(r);return t.length>0&&(o=o.filter(function(e){return-1==t.indexOf(e)})),n.concat(o)},[]),n.concat(t)},e}();t.BaseLiteItem=e,__reflect(e.prototype,"meru.BaseLiteItem");var n=function(){function n(t){this._rules=[],this._itemMap={},this._lists=[],this._hasEvent=!1,this._hasNew=!1,this._type=t}return n.prototype.valid=function(t){return 0==this._rules.length?!0:this._rules.some(function(e){return e.valid(t)})},n.prototype.addItem=function(t,n,r){for(var o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];this._itemMap.hasOwnProperty(t)||(this._itemMap[t]=new e(t,n,r)),(a=this._itemMap[t]).addParams.apply(a,o);var a},n.prototype.rule=function(e){if(is.string(e)){var n=e;this._rules.push(t.ListRule.add(n))}else if(is.fun(e)){var r=e;this._rules.push(t.ListRule.fun(r))}else{var o=e;this._rules.push(o)}return this},n.prototype.sort=function(t){return this._sort=t,this},n.prototype.setList=function(t){return this._lists=t,this},n.prototype.getList=function(){var t=this;if(this._sources&&!this._hasNew)return this._sources;this._hasNew=!1;var e=this._lists;for(var n in this._itemMap){var r=this._itemMap[n];e=r.getList(e)}return e=e.filter(function(e){return t.valid(e)}),this._sort&&e.sort(this._sort.sort),this._sources=e,this._sources},n.prototype.getCollection=function(){if(!this._collection){var e=this.getList();this._collection=new eui.ArrayCollection(e),t.addNotification(t.k.ADD_MODEL(this._type),this.onAdd,this),t.addNotification(t.k.DELETE_MODEL(this._type),this.onDelete,this)}return this._collection},n.prototype.dispose=function(){t.removeNotificationByTarget(this)},n.prototype.onAdd=function(t){for(var e=0;e<t.length;e++){var n=t[e];this.check(n)&&(this._hasNew=!0,this._collection&&this._collection.source.push(n))}this._collection&&this._hasNew&&(this._sort&&this._collection.source.sort(this._sort.sort),eui.CollectionEvent.dispatchCollectionEvent(this._collection,eui.CollectionEvent.COLLECTION_CHANGE,eui.CollectionEventKind.RESET))},n.prototype.check=function(t){var e=this,n=!0,r=Object.keys(this._itemMap);return r.length>=0&&(n=r.some(function(n){return e._itemMap[n].check(t)})),n?this.valid(t):n},n.prototype.onDelete=function(t){if(t.length>0&&this._collection)for(var e=[].concat(t);e.length>0;){var n=e.shift(),r=this._collection.getItemIndex(n);r>-1&&this._collection.removeItemAt(r)}},n}();t.BaseList=n,__reflect(n.prototype,"meru.BaseList")}(meru||(meru={}));var meru;!function(t){var e;!function(t){t[t.equal=0]="equal",t[t.greaterThen=1]="greaterThen",t[t.greaterEqual=2]="greaterEqual",t[t.lessThen=3]="lessThen",t[t.lessEqual=4]="lessEqual",t[t.truthy=5]="truthy",t[t.falsy=6]="falsy"}(e=t.ListCond||(t.ListCond={}));var n=function(){function n(t,e,n){e?(this.name=t,this.cond=e,this.value=n):this.parse(t)}return n.prototype.parse=function(t){var r=/^\s*(\!)?([a-zA-Z\.0-9]+)\s*([\>\<\=]+)?\s*(.*?)?\s*$/gi,o=r.exec(t);if(o){var i=o[1],a=o[2],s=o[3],u=o[4];this.name=a,this.value=u,i?this.cond=e.falsy:s?this.cond=n.condMap[s]:this.cond=e.truthy}},n.prototype.valid=function(n){var r=t.object.getValue(n,this.name,null);switch(this.cond){case e.truthy:return is.truthy(r);case e.falsy:return is.falsy(r);case e.equal:return r==this.value;case e.greaterThen:return r>this.value;case e.lessThen:return r<this.value;case e.greaterEqual:return r>=this.value;case e.lessEqual:return r<=this.value}},n.condMap={"==":e.equal,">=":e.greaterEqual,">":e.greaterThen,"<=":e.lessEqual,"<":e.lessThen},n}();t.ListCondInfo=n,__reflect(n.prototype,"meru.ListCondInfo",["meru.IListCondInfo"]);var r=function(){function t(t){this._fun=t}return t.prototype.valid=function(t){return this._fun(t)},t}();t.FunCondInfo=r,__reflect(r.prototype,"meru.FunCondInfo",["meru.IListCondInfo"]);var o=function(){function t(){this._conditions=[]}return t.prototype.add=function(t,e,r){if(t.indexOf("&&")>-1)for(var o=t.split("&&"),i=0;i<o.length;i++)this._conditions.push(new n(o[i]));else this._conditions.push(new n(t,e,r));return this},t.prototype.fun=function(t){return this._conditions.push(new r(t)),this},t.fun=function(e){return(new t).fun(e)},t.add=function(e,n,r){return(new t).add(e,n,r)},t.prototype.valid=function(t){return this._conditions.every(function(e){return e.valid(t)})},t}();t.ListRule=o,__reflect(o.prototype,"meru.ListRule")}(meru||(meru={}));var meru;!function(t){var e;!function(t){t[t.asc=0]="asc",t[t.desc=1]="desc"}(e=t.SortDir||(t.SortDir={}));var n=function(){function n(t,e){this.property=t,this.type=e}return n.prototype.sort=function(n,r){var o=t.object.getValue(n,this.property,0),i=t.object.getValue(r,this.property,0);return this.type==e.desc?i-o:o-i},n}();t.SortItemInfo=n,__reflect(n.prototype,"meru.SortItemInfo");var r=function(){function t(){this._sorts=[],this._isInvert=!1}return t.prototype.desc=function(t){return this._sorts.push(new n(t,e.desc)),this},t.prototype.asc=function(t){return this._sorts.push(new n(t,e.asc)),this},t.prototype.custom=function(t){return this._sorts.push(t),this},Object.defineProperty(t.prototype,"sort",{get:function(){return this._sort.bind(this)},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){for(var t=[],r=this._sorts.length,o=0;r>o;o++){var i=this._sorts[r-1-o],a=new n(i.property,i.type==e.desc?e.asc:e.desc);t.push(a)}return t},t.prototype._sort=function(t,e){for(var r=this._isInvert?this.reverse():this._sorts,o=0;o<r.length;o++){var i=r[o],a=null;a=i instanceof n?i.sort.bind(i):i;var s=a(t,e);if(0!=s)return s}return 0},t.desc=function(e){return(new t).desc(e)},t.asc=function(e){return(new t).asc(e)},t.custom=function(e){return(new t).custom(e)},t.prototype.invert=function(){return this._isInvert=!0,this},t}();t.Sort=r,__reflect(r.prototype,"meru.Sort")}(meru||(meru={}));var meru;!function(t){var e=function(e){function n(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=e.call(this,null)||this;r._subProxys=[];var o=[];if(1==t.length&&Array.isArray(t[0]))o=t[0];else if(t.length>0)for(var i=0;i<t.length;i++)o.push(t[i]);if(o)for(var i=0;i<o.length;i++)r.addSubProxy(o[i]);return r.addParam("m",1),r}return __extends(n,e),n.prototype.load=function(){0!=this._subProxys.length&&e.prototype.load.call(this)},n.prototype.getParamString=function(){var e=[];return this._subProxys.forEach(function(n){var r={};for(var o in n.params)-1==t.Proxy.frontProxyKeys.indexOf(o)&&(r[o]=n.params[o]);e.push(r)},this),JSON.stringify(e)},n.prototype.onResponse=function(e){var n=this;e?(this._responseData=e,this._subProxys.forEach(function(t){var e=t.getParamByName("mod"),r=t.getParamByName("do");t.onResponse(n.responseData[e][r])},this),this._isRequestSucceed=!0,this._isResponseSucceed=!0,t.postNotification(t.ProxyAction.MULTIPROXY_SUCCEED,this),this.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.RESPONSE_SUCCEED,this)),this.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.REQUEST_SUCCEED,this))):(this._isRequestSucceed=!0,this._isResponseSucceed=!1,this._errorCode=-1e3,t.postNotification(t.ProxyAction.MULTIPROXY_ERROR,this),this.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.RESPONSE_ERROR,this)),this.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.REQUEST_SUCCEED,this)),this.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.ERROR,this))),this.proxyDone()},Object.defineProperty(n.prototype,"subProxyList",{get:function(){return this._subProxys},enumerable:!0,configurable:!0}),n.prototype.getParamByName=function(t){for(var e=0;e<this._subProxys.length;e++){var n=this._subProxys[e].getParamByName(t);if(null!=n)return n}return null},n.prototype.addSubProxy=function(e){if(e&&e.hasOwnProperty("moddo")){var r=new t.SingleProxy(e);this._subProxys.push(r)}else if(e instanceof t.SingleProxy)this._subProxys.push(e);else if(e instanceof n){var o=e,i=this;o._subProxys.forEach(function(t){i.addSubProxy(t)},this)}},n}(t.Proxy);t.MultiProxy=e,__reflect(e.prototype,"meru.MultiProxy");var n=function(t){function e(e){var n=t.call(this)||this;return n._waitTime=0,n._waitTime=e,egret.setTimeout(n.load,n,n._waitTime),n}return __extends(e,t),e.prototype.load=function(){e._cur=null,t.prototype.load.call(this)},e.getProxy=function(){return null==this._cur&&(this._cur=new e(500)),this._cur},e._cur=null,e}(e);t.AutoMergeProxy=n,__reflect(n.prototype,"meru.AutoMergeProxy")}(meru||(meru={}));var meru;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getIsComplete=function(){return!0},Object.defineProperty(e.prototype,"isComplete",{get:function(){return this.getIsComplete()},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){return null},e.prototype.unserialize=function(t){},e.prototype.setName=function(t){this.__name=t;var e=this;return e},e.prototype.getName=function(){return this.__name},e.prototype.getType=function(){return"none"},Object.defineProperty(e.prototype,"type",{get:function(){return this.getType()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this._state=t},enumerable:!0,configurable:!0}),e.prototype.setComplete=function(){},e.prototype.enter=function(t){},e.prototype.exit=function(t){},e}(egret.HashObject);t.BaseOperate=e,__reflect(e.prototype,"meru.BaseOperate",["meru.IComponentOperate"])}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){}return t.WAIT="proxy_status_wait",t.RESPONSE="proxy_status_response",t.BEGIN_LOAD="load_proxy",t.REQUEST="proxy_status_reqeust",t.REQUEST_SUCCEED="proxy_request_succeed",t.RESPONSE_SUCCEED="proxy_response_succeed",t.REQUEST_ERROR="proxy_request_error",t.RESPONSE_ERROR="proxy_response_error",t.TIMEOUT="proxy_timeout",t.MULTIPROXY_ERROR="multiproxy_response_error",t.MULTIPROXY_SUCCEED="multiproxy_response_succeed",t}();t.ProxyAction=e,__reflect(e.prototype,"meru.ProxyAction")}(meru||(meru={}));var meru;!function(t){function e(t,e,n,r){void 0===e&&(e={}),void 0===n&&(n=!1),void 0===r&&(r=!0);var o={moddo:t,mask:r,cache:n,params:e};return o}function n(){return t.___userInfo}function r(e,r,o){var i,s,u;if(is.string(e)?i=e:e&&e.moddo&&(s=e),is.truthy(r)&&(r&&r.moddo?s=r:u=r),is.falsy(u)&&(u=o),is.falsy(s)&&(s=n()),is.falsy(i))return a.getCache(s.moddo);var c=a.getCache(s.moddo);return c?t.object.getValue(c,i,u):u}function o(e,n){void 0===n&&(n=null);var r=e.split("."),o={moddo:r.slice(0,2).join(".")};return 2==r.length?t.getCache(o,n):t.getCache(r.slice(2).join("."),o,n)}function i(t){return void 0===t&&(t=n()),a.isCache(t.moddo)}var a=function(){function e(){this._cacheData={}}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.reset=function(){var t=this._cacheData.Server.getList;this._cacheData={Server:{getList:t}}},e.prototype.resetOne=function(t,e){void 0===e&&(e=null);var n=this.formatParmas(t,e);this._cacheData.hasOwnProperty(n[0])&&delete this._cacheData[n[0]][n[1]]},e.prototype.setCache=function(e){var n=e.params;if(n.hasOwnProperty("cache")&&n.cache===!0){var r=e.responseData,o=e.getParamByName("mod"),i=e.getParamByName("do");this._cacheData.hasOwnProperty(o)||(this._cacheData[o]={}),n.hasOwnProperty("dataMerge")&&n.dataMerge===!0?this._cacheData[o][i]=this.dataMerge(this._cacheData[o][i],r):this._cacheData[o][i]=r,t.postNotification(t.k.Cache(o+"."+i),r),t.postNotification(t.k.All(o+"."+i)),t.postNotification(t.k.CacheChange,o+"."+i,r)}},e.prototype.dataMerge=function(t,e){var n=t||{};for(var r in e)n[r]=e[r];return n},e.prototype.getCache=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),null==t)return this._cacheData;if(this.isCache(t,e)){var n=this.formatParmas(t,e);return this._cacheData[n[0]][n[1]]}return null},e.prototype.formatParmas=function(t,e){if(void 0===e&&(e=null),null==e){var n=t.split(".");t=n[0],e=n[1]}return[t,e]},e.prototype.isCache=function(t,e){void 0===e&&(e=null);var n=this.formatParmas(t,e);return this._cacheData.hasOwnProperty(n[0])&&this._cacheData[n[0]].hasOwnProperty(n[1])},e.setCache=function(t){e.instance.setCache(t)},e.getCache=function(n){return void 0===n&&(n=null),e.instance.getCache(t.k.getModDo(n))},e.resetOne=function(n){e.instance.resetOne(t.k.getModDo(n))},e.reset=function(){return e.instance.reset()},e.isCache=function(n){return e.instance.isCache(t.k.getModDo(n))},e._instance=null,e}();t.ProxyCache=a,__reflect(a.prototype,"meru.ProxyCache"),t.buildProxyInfo=e,t.___userInfo=e("User.getInfo",{},!0),t.User_getInfo=n,t.getCache=r,t.getWhereValue=o,t.hasCache=i}(meru||(meru={}));var meru;!function(t){var e=function(t){function e(e,n,r,o){var i=t.call(this,e,r,o)||this;return i._responseData=n.responseData,i._errorCode=n.errorCode,i._errorMessage=n.errorMessage,i._isRequestSucceed=n.isRequestSucceed,i._isResponseSucceed=n.isResponseSucceed,i}return __extends(e,t),Object.defineProperty(e.prototype,"responseData",{get:function(){return this._responseData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorCode",{get:function(){return this._errorCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorMessage",{get:function(){return this._errorMessage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isResponseSucceed",{get:function(){return this._isResponseSucceed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRequestSucceed",{get:function(){return this._isRequestSucceed},enumerable:!0,configurable:!0}),e.CANCEL="cancel",e.REQUEST_SUCCEED="requestSucceed",e.REQUEST_FAIL="fail",e.RESPONSE_SUCCEED="respnseSucceed",e.RESPONSE_ERROR="error",e.ERROR="global_error",e.TIME_OUT="timeout",e}(egret.Event);t.ProxyEvent=e,__reflect(e.prototype,"meru.ProxyEvent")}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){}return t.DEFAULT=1,t.REQUEST=2,t.WAIT=4,t.RESPONSE=8,t}();t.ProxyStatus=e,__reflect(e.prototype,"meru.ProxyStatus")}(meru||(meru={}));var meru;!function(t){var e=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.update=function(t,n){e.instance.update(t,n)},e.prototype.isArray=function(t){return t instanceof Array},e.prototype.isObject=function(t){var e=t.toString();return e.indexOf("object")>-1},e.prototype.isNumeric=function(t){return parseFloat(t).toString()==t.toString()},e.customUpdate=function(t,n){e.instance.customUpdate(t,n)},e.prototype.isNormal=function(t){var e=t.indexOf("@")>-1,n=t.indexOf(".")>-1,r=t.indexOf("_")>-1;return!e&&!n&&!r},e.prototype.isAddToArray=function(t){return"@a"==t},e.prototype.isRemoveToArray=function(t){var e=t.split("_");return e.length<=3&&"@d"==e[0]},e.prototype.isFilter=function(t){var e=t.split("_");return"@f"==e[0]},e.prototype._updateObject=function(t,e,n){var r=t.split(".");"@a"==r[0]||"@s"==r[0]?this.isArray(n)?n[parseInt(r[1])]=e:n[r[1]]=e:"@d"==r[0]&&delete n[r[1]]},e.prototype._getFilterObject=function(t,e){if(e){var n=t.split("_");if(2==n.length&&"@f"==n[0]&&this.isArray(e)){var r=parseInt(n[1]);return e[r]}if(3==n.length&&"@f"==n[0]&&this.isArray(e))for(var o=n[1],i=n[2],a=0;a<e.length;a++){var s=e[a];if(3==n.length&&this.isObject(s)){var u=s[o];if(null!=u&&void 0!=e&&("@"==i[0]&&(i=i.replace("@","")),i==u))return s}}}return null},e.prototype._addObjectToArray=function(t,e){if(this.isArray(e))for(var n=0;n<e.length;n++)t.push(e[n]);else t.push(e)},e.prototype._sliceCaceData=function(t,e){t[e];t.splice(e,1)},e.prototype._removeObjectFromArray=function(t,e,n){var r=e.split("_");if(r.length<=3&&"@d"==r[0]&&this.isArray(t))for(var o=t.length,i=o-1;i>=0;i--){var a=t[i];if(3==r.length){if(a.hasOwnProperty(r[1])){var s=r[2];"@"==s[0]&&(s=s.replace("@","")),s==a[r[1]]&&this._sliceCaceData(t,i)}}else 2==r.length&&a.hasOwnProperty(r[1])?n==a[r[1]]&&this._sliceCaceData(t,i):1==r.length&&n==a&&this._sliceCaceData(t,i)}},e.prototype.update=function(e,n){var r=e.responseData.c,o=[];for(var i in r){var a=r[i],s=i.split("."),u=s[0],c=s[1];n.hasOwnProperty(u)&&n[u].hasOwnProperty(c)&&(t.postNotification(t.k.BeforeChange(u+"."+c),a),this._update(n[u][c],a),this.postAction(u,c,a),o.push([u,c,a]))}for(var h=0;h<o.length;h++){var p=o[h];t.postNotification(t.k.AfterChange(p[0]+"."+p[1]),p[2])}},e.prototype.postAction=function(e,n,r){t.postNotification(t.k.Change(e+"."+n),r),t.postNotification(t.k.All(e+"."+n))},e.prototype.customUpdate=function(e,n){var r=t.ProxyCache.getCache(e);this._update(r,n);var o=e.split(".");this.postAction(o[0],o[1],n)},e.prototype._update=function(t,e){if(t&&e&&this.isObject(e))for(var n in e){var r=e[n];if(this.isNormal(n)&&this.isObject(r))t.hasOwnProperty(n)&&this._update(t[n],r);else if(this.isNormal(n)&&this.isNumeric(r)){var o=t[n];t[n]=o+r}else if(this.isNormal(n))t[n]=r;else if(this.isAddToArray(n))this._addObjectToArray(t,r);else if(this.isRemoveToArray(n))this._removeObjectFromArray(t,n,r);else if(this.isFilter(n)){var i=this._getFilterObject(n,t);i&&this._update(i,r)}else this._updateObject(n,r,t)}},e}();t.ProxyUpdate=e,__reflect(e.prototype,"meru.ProxyUpdate")}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){}return t.SUCCEED=1,t.ERROR=2,t}();t.RequestStatus=e,__reflect(e.prototype,"meru.RequestStatus")}(meru||(meru={}));var meru;!function(t){function e(t){var e={};return t.moddo&&(e.mod=t.moddo),t.params&&(e.p=t.params||{}),(t.mask===!0||"undefined"==typeof t.mask)&&(e.mask=!0),t.cache===!0&&(e.cache=!0),t.dataMerge===!0&&(e.dataMerge=!0),t.delay&&(e.delay=t.delay),e}function n(){for(var e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=new Promise(function(r,o){for(var i=new t.MultiProxy,a=0;a<n.length;a++){var s=n[a];i.addSubProxy(s)}i.addEventListener(t.ProxyEvent.REQUEST_SUCCEED,function(t){try{r(t.responseData)}catch(t){}},e),i.addEventListener(t.ProxyEvent.ERROR,function(t){try{o(t)}catch(t){}},e),i.load()});return o}function r(e,n){var r=this;if(void 0===n&&(n=!1),n&&a[e.moddo])return a[e.moddo];var o=new Promise(function(o,s){var u=new i(e);u.addEventListener(t.ProxyEvent.RESPONSE_SUCCEED,function(t){try{o(t.responseData)}catch(t){}n&&delete a[e.moddo]},r),u.addEventListener(t.ProxyEvent.ERROR,function(t){try{s(t)}catch(t){}n&&delete a[e.moddo]},r),u.load()});return a[e.moddo]=o,o}var o=function(){function t(){this._tickObj={},this._tickId=null,this.refreshTick()}return t.prototype.refreshTick=function(){null==this._tickId&&(this._tickId=egret.setInterval(this.tick,this,1e3))},t.prototype.tick=function(){for(var t in this._tickObj)this._tickObj[t]--,this._tickObj[t]<=0&&delete this._tickObj[t];0==Object.keys(this._tickObj).length&&(egret.clearInterval(this._tickId),this._tickId=null)},t.prototype.getLeftime=function(t){return this._tickObj.hasOwnProperty(t)?this._tickObj[t]:0},t.prototype.push=function(t,e){this._tickObj[t]=e,this.refreshTick()},t.getInstance=function(){return null==t._inst&&(t._inst=new t),t._inst},t}();t.ProxyTime=o,__reflect(o.prototype,"meru.ProxyTime");var i=function(n){function r(t){void 0===t&&(t={});var r=this;return t=e(t),r=n.call(this,t)||this}return __extends(r,n),r.prototype.getParamString=function(){var e={};
for(var n in this._params)-1==t.Proxy.frontProxyKeys.indexOf(n)&&(e[n]=this._params[n]);return JSON.stringify(e)},r.prototype.load=function(){if(1==this.getParamByName("autoMerge"))t.AutoMergeProxy.getProxy().addSubProxy(this);else{var e=this.getParamByName("delay");if(e){var r=e.time,i=this.getParamByName("mod"),a=this.getParamByName("do"),s=e.type||"",u=i+"."+a;""!=s&&(u+="."+s),0==o.getInstance().getLeftime(u)?(o.getInstance().push(u,r),n.prototype.load.call(this)):this.dispatchEvent(new t.ProxyEvent(t.ProxyEvent.RESPONSE_SUCCEED,this))}else n.prototype.load.call(this)}},r}(t.Proxy);t.SingleProxy=i,__reflect(i.prototype,"meru.SingleProxy"),t.multiRequest=n;var a={};t.request=r}(meru||(meru={}));var meru;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n._notice="",n._data=null,n._dataMapArr=[],n.labelDisplay=null,n._label="",n.iconDisplay=null,n._icon=null,n.touchCaptured=!1,n._isStop=!1,n._pt=new t.Vec2d,n._pt2=new t.Vec2d,n.touchChildren=!1,n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n.onTouchBegin,n),n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onEnter,n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.onExit,n),n}return __extends(n,e),n.prototype.onExit=function(){t.removePullObject(t.k.GET_BUTTON,this.getButton,this)},n.prototype.onEnter=function(){t.addPullObject(t.k.GET_BUTTON,this.getButton,this)},n.prototype.getButton=function(e){return t.display.isVisible(this)&&this.name==e?this:void 0},Object.defineProperty(n.prototype,"notice",{get:function(){return this._notice},set:function(t){this._notice=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,null!=t&&this.addDataMap("data"),eui.PropertyEvent.dispatchPropertyEvent(this,eui.PropertyEvent.PROPERTY_CHANGE,"data"),this.dataChanged()},enumerable:!0,configurable:!0}),n.prototype.addDataMap=function(t){-1==this._dataMapArr.indexOf(t)&&this._dataMapArr.push(t)},n.prototype.dataChanged=function(){},Object.defineProperty(n.prototype,"label",{get:function(){return this._label},set:function(t){this._label=t,this.labelDisplay&&(this.labelDisplay.text=t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"icon",{get:function(){return this._icon},set:function(t){this._icon=t,this.iconDisplay&&this.setIconSource(t)},enumerable:!0,configurable:!0}),n.prototype.onTouchBegin=function(t){this._isStop=!1,this._pt.x=t.stageX,this._pt.y=t.stageY,this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchMove,this),this.touchCaptured=!0,this.invalidateState(),t.updateAfterEvent()},n.prototype.onStageTouchMove=function(t){if(this._pt2.x=t.stageX,this._pt2.y=t.stageY,this._pt2.distance(this._pt)>12){var e=t.currentTarget;this._isStop=!0,e.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchMove,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.onTouchEnd(t)}},n.prototype.onStageTouchEnd=function(e){var n=e.currentTarget;n.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchMove,this),n.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.contains(e.target)&&(this.buttonReleased(),this.name&&t.postNotification(t.k.CLICK_BUTTON,this.name,this)),this.onTouchEnd(e)},n.prototype.onTouchEnd=function(t){this.touchCaptured=!1,this.invalidateState()},n.prototype.getCurrentState=function(){var t=this.skin.currentState,e="up";return this.enabled||(e="disabled"),this.touchCaptured&&(e="down"),this.skin.hasState(e)?e:t},n.prototype.partAdded=function(t,e){e===this.labelDisplay?this.labelDisplay.text=this._label:e==this.iconDisplay&&this.setIconSource(this._icon)},n.prototype.setIconSource=function(t){this.iconDisplay&&is.truthy(t)?(this.iconDisplay.source=t,this.iconDisplay.includeInLayout=this.iconDisplay.visible=!0):this.iconDisplay&&(this.iconDisplay.includeInLayout=this.iconDisplay.visible=!1)},n.prototype.destoryData=function(){for(;this._dataMapArr.length;)this[this._dataMapArr.shift()]=null},n.prototype.buttonReleased=function(){if(is.truthy(this._notice)){var e=this.data;if(!e){var n=t.display.getHostComponent(this);n&&(e=n.data)}t.postNotification(t.str.formatNotice(this._notice),e,n,this)}},n}(eui.Component);t.Button=e,__reflect(e.prototype,"meru.Button");var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._lightable=!0,e}return __extends(e,t),e.getLightFilter=function(){return e.__lightFilter||(e.__lightFilter=new egret.ColorMatrixFilter([1.4,0,0,0,0,0,1.4,0,0,0,0,0,1.4,0,0,0,0,0,1.4,0])),e.__lightFilter},Object.defineProperty(e.prototype,"lightable",{get:function(){return this._lightable},set:function(t){this._lightable=t},enumerable:!0,configurable:!0}),e.prototype.onTouchBegin=function(n){t.prototype.onTouchBegin.call(this,n),this.lightable&&(this.filters=[e.getLightFilter()])},e.prototype.onTouchEnd=function(e){t.prototype.onTouchEnd.call(this,e),this.lightable&&(this.filters=[])},e.prototype.onStageTouchEnd=function(e){t.prototype.onStageTouchEnd.call(this,e),this.lightable&&(this.filters=[])},e}(e);t.Button2=n,__reflect(n.prototype,"meru.Button2")}(meru||(meru={}));var meru;!function(t){function e(e,n,r,o){void 0===o&&(o=0),t.singleton(u).addObserver(e,n,r,o)}function n(e,n,r,o){void 0===o&&(o=0),t.singleton(u).onceObserver(e,n,r,o)}function r(e,n,r){t.singleton(u).removeObserver(e,n,r)}function o(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=t.singleton(u);o.postNotification.apply(o,[e].concat(n))}function i(e){t.singleton(u).removeObserverByObject(e)}function a(e){t.singleton(u).removeObserverByName(e)}function s(e){i(e),t.removePullObjectByTarget(e)}var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.postNotification=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.postTypeNoticetion(t,e),this.postTypeNoticetion("ALL",[t].concat(e))},e.prototype.postTypeNoticetion=function(t,e){var n=this._nameObservers[t];if(n){var r=[];for(var o in n){var i=n[o];r=r.concat(i)}r.sort(function(t,e){return e.priority-t.priority});for(var a=0;a<r.length;a++)r[a].sender.apply(r[a].context,e)}},e}(t.BaseNotification);t.Notification=u,__reflect(u.prototype,"meru.Notification"),t.addNotification=e,t.onceNotification=n,t.removeNotification=r,t.postNotification=o,t.removeNotificationByTarget=i,t.removeNotificationByName=a,t.removeNoticeAndPullByTarget=s}(meru||(meru={}));var meru;!function(t){function e(e,n,r,o){void 0===o&&(o=0),t.singleton(a).addObserver(e,n,r,o)}function n(e,n,r){t.singleton(a).removeObserver(e,n,r)}function r(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return(o=t.singleton(a)).pullObject.apply(o,[e].concat(n));var o}function o(e){t.singleton(a).removeObserverByObject(e)}function i(e){t.singleton(a).removeObserverByName(e)}var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.pullObject=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this._pullObject(t,e,0);return e[0]=r,r=this._pullObject("ALL",[t].concat(e),1)},e.prototype._pullObject=function(t,e,n){void 0===n&&(n=0);var r=this._nameObservers[t];for(var o in r)for(var i=r[o],a=0;a<i.length;a++){var s=i[a],u=s.sender.apply(s.context,e);"undefined"!=typeof u&&(e[n]=u)}return e[n]},e}(t.BaseNotification);t.PullObject=a,__reflect(a.prototype,"meru.PullObject"),t.addPullObject=e,t.removePullObject=n,t.pullObject=r,t.removePullObjectByTarget=o,t.removePullObjectByName=i}(meru||(meru={}));var meru;!function(t){function e(t){return r.getPool(t)}function n(t,e){return r.getTypePool(t,e)}var r=function(){function e(t){this._totalArr=[],this._useArr=[],this._leftArr=[],this._type=t}return e.prototype.push=function(e){t.array.remove(this._useArr,e),-1==this._leftArr.indexOf(e)&&this._leftArr.push(e)},e.prototype.pop=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0==this._leftArr.length){var n=new this._type;this._leftArr.push(n),this._totalArr.push(n)}var r=this._leftArr.shift();return is.fun(r.init)&&r.init.apply(r,t),this._useArr.push(r),r},e.getPool=function(n){var r=t.getTypeId(n);return this._poolMap.hasOwnProperty(r)||(this._poolMap[r]=new e(n)),this._poolMap[r]},e.getTypePool=function(n,r){var o=n+t.getTypeId(r);return this._poolMap.hasOwnProperty(o)||(this._poolMap[o]=new e(r)),this._poolMap[o]},e._poolMap={},e}();t.Pool=r,__reflect(r.prototype,"meru.Pool"),t.getPool=e,t.getTypePool=n}(meru||(meru={}));var meru;!function(t){function e(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++)eui.PropertyEvent.dispatchPropertyEvent(t,eui.PropertyEvent.PROPERTY_CHANGE,e[r])}function n(t,e,r,o){void 0===r&&(r=[]),void 0===o&&(o=[]);var i=function(t,e,n){var r=eui.Binding.bindHandler(t,e,function(){var e=t;if(is.fun(n))n();else{var r=n.split("."),o=r.length;if(r.length>1)for(var i=0;e&&o-2>=i;)e=e[r[i]],i++;eui.PropertyEvent.dispatchPropertyEvent(e,eui.PropertyEvent.PROPERTY_CHANGE,r[o-1])}},this);o.push(r)};for(var a in e){var s=e[a];"string"==typeof s&&(s=[s]);var u=r.concat(a);if(Array.isArray(s))for(var c=s.length;c--;)i(t,u.concat([]),s[c]);else n(t,s,u,o)}return o}function r(e,n){e["$_"+n]&&(e["$_"+n]=null),t.propertyChange(e,n)}function o(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];return t["$_"+e]||(r=r.map(function(t){return is.fun(t)?t():t}),t["$_"+e]=new(n.bind.apply(n,[void 0].concat(r)))),t["$_"+e]}var i=function(t){function e(e){void 0===e&&(e=null);var n=t.call(this)||this;return n._skinDataMap={},n._patternDataMap={},n._skinName=e,n.init(),n}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this.getName()},enumerable:!0,configurable:!0}),e.prototype.getName=function(){return""},e.prototype.getModelByName=function(t){return this.name==t?this:null},e.prototype.getData=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t==this._skinName)return this;var r=this.scanDataItem(t);return null!=r?r.obj[r.key].apply(this,e):void 0},e.prototype.getModel=function(t){return egret.is(this,t.prototype.__class__)?this:null},e.prototype.scanDataItem=function(t){if(this._skinDataMap.hasOwnProperty(t))return{obj:this._skinDataMap,key:t};for(var e in this._patternDataMap)if(this.isMatch(e,t))return{obj:this._patternDataMap,key:e};return null},e.prototype.isMatch=function(t,e){for(var n="^",r=0;r<t.length;r++){var o=t[r];n+="*"==o?".*":"?"==o?".{0,1}":o}return n+="$",null!=e.match(n)},e.prototype.has=function(t){return this._skinName==t?!0:null!=this.scanDataItem(t)},e.prototype.slot=function(t,e){var n=this,r=t.indexOf("?")>-1||t.indexOf("*")>-1?this._patternDataMap:this._skinDataMap;is.fun(e)?r[t]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.apply(n,t)}:r[t]=function(){return e}},e.prototype.init=function(){},e}(egret.EventDispatcher);t.BaseData=i,__reflect(i.prototype,"meru.BaseData",["meru.IData"]);var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.sub=function(t){this.models.push(t)},e.prototype.getModel=function(e){var n=t.prototype.getModel.call(this,e);if(n)return n;for(var r=0;r<this.models.length;r++)if(n=this.models[r].getModel(e))return n;return null},e.prototype.getModelByName=function(t){var e=this.getModelByName(t);if(e)return e;for(var n=0;n<this.models.length;n++)if(e=this.models[n].getModelByName(t))return e;return e},e.prototype.getData=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=t.prototype.getData.apply(this,[e].concat(n));if(is.undefined(o))for(var i=0;i<this.models.length;i++)if(o=(a=this.models[i]).getData.apply(a,[e].concat(n)),!is.undefined(o))return o;return o;var a},e.prototype.has=function(e){var n=t.prototype.has.call(this,e);if(n)return n;for(var r=0;r<this.models.length;r++)if(this.models[r].has(e))return!0;return!1},Object.defineProperty(e.prototype,"models",{get:function(){return this._modelArr||(this._modelArr=[]),this._modelArr},enumerable:!0,configurable:!0}),e}(i);t.GroupData=a,__reflect(a.prototype,"meru.GroupData");var s=function(){function t(){this._methodMap={},this.init()}return t.prototype.on=function(t,e){var n=this;this._methodMap[t]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e.apply(n,t)}},t.prototype.getMutation=function(t){return egret.is(this,t.prototype.__class__)?this:null},t.prototype.onNotice=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this._methodMap[t]&&(r=this._methodMap)[t].apply(r,e);var r},t.prototype.hasNotice=function(t){return this._methodMap.hasOwnProperty(t)},t.prototype.init=function(){},t}();t.BaseMutation=s,__reflect(s.prototype,"meru.BaseMutation",["meru.IMutation"]);var u=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onNotice=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];t.prototype.onNotice.apply(this,[e].concat(n));for(var o=this.mutations.length,i=0;o>i;i++){var a=this.mutations[i];a.hasNotice(e)&&a.onNotice.apply(a,[e].concat(n))}},e.prototype.getModel=function(e){var n=t.prototype.getMutation.call(this,e);if(n)return n;for(var r=0;r<this._mutationArr.length;r++)if(n=this._mutationArr[r].getMutation(e))return n;return null},e.prototype.hasNotice=function(t){return!0},Object.defineProperty(e.prototype,"mutations",{get:function(){return this._mutationArr||(this._mutationArr=[]),this._mutationArr},enumerable:!0,configurable:!0}),e.prototype.sub=function(t){this.mutations.push(t)},e.prototype.init=function(){},e}(s);t.GroupMutation=u,__reflect(u.prototype,"meru.GroupMutation");var c=function(){function t(t){this._name=t}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mutation",{get:function(){return this._mutation},set:function(t){this._mutation=t},enumerable:!0,configurable:!0}),t}();t.Struct=c,__reflect(c.prototype,"meru.Struct"),t.propertyChange=e,t.dependProperty=n,t.changeDataProperty=r,t.getDataProperty=o}(meru||(meru={}));var meru;!function(t){function e(t,e){u.injectionData(t,e)}function n(t,e){u.injectionMutation(t,e)}function r(t){return u.getStruct(t)}function o(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return u.pullObject.apply(u,[t].concat(e))}function i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++)eui.PropertyEvent.dispatchPropertyEvent(t,eui.PropertyEvent.PROPERTY_CHANGE,e[r])}function a(t){return u.getMutation(t)}function s(t){return u.getData(t)}var u=function(){function e(){}return e.init=function(){this._intialized||(this._intialized=!0,t.addNotification("ALL",this.onListener,this),t.addPullObject("getSkinData",this.pullObject,this),t.addPullObject("ALL",this.getAllData,this))},e.onListener=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=t.pullObject.apply(t,[t.k.SKIP_MUTATION,e].concat(n));if(o!==!0){var i=e.split("|"),a=i[0].split(".");if(i=[i.slice(1).join("|")],a.length>=2){if(this._moduleMap.hasOwnProperty(a[0])){var s=this._moduleMap[a[0]];i=[a.slice(1).join(".")].concat(n,i),s.mutation.onNotice.apply(s.mutation,i)}}else if(this._moduleMap.hasOwnProperty("COMMON")){var s=this._moduleMap.COMMON;i=[a[0]].concat(n,i),s.mutation.onNotice.apply(s.mutation,i)}}},e.getAllData=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=t.split(".");if(r.length>=2&&this._moduleMap.hasOwnProperty(r[0])&&this._moduleMap[r[0]].data){var o=this._moduleMap[r[0]];return e=[r.slice(1).join(".")].concat(e),o.data.getData.apply(o.data,e)}},e.pullObject=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n in this._moduleMap){var r=this._moduleMap[n].data;if(r&&r.has(t[0]))return r.getData.apply(r,t)}return null},e.getData=function(e){var n=t.getTypeId(e);if(!this._dataMap.hasOwnProperty(n))for(var r in this._moduleMap){var o=this._moduleMap[r];if(o.data){var i=o.data.getModel(e);if(i){this._dataMap[n]=i;break}}}return this._dataMap[n]},e.getMutation=function(e){var n=t.getTypeId(e);if(!this._mutationMap.hasOwnProperty(n))for(var r in this._moduleMap){var o=this._moduleMap[r];if(o.mutation){var i=o.mutation.getMutation(e);if(i){this._mutationMap[n]=i;break}}}return this._mutationMap[n]},e.getStruct=function(t){return this._moduleMap[t]},e.injectionData=function(e,n){this.init(),this._moduleMap.hasOwnProperty(e)||(this._moduleMap[e]=new t.Struct(e)),this._moduleMap[e].data=new n},e.injectionMutation=function(e,n){this.init(),this._moduleMap.hasOwnProperty(e)||(this._moduleMap[e]=new t.Struct(e)),this._moduleMap[e].mutation=new n},e._moduleMap={},e._intialized=!1,e._dataMap={},e._mutationMap={},e}();t.StructCenter=u,__reflect(u.prototype,"meru.StructCenter"),t.injectionData=e,t.injectionMutation=n,t.getStruct=r,t.getDataSlot=o,t.notifyDataChange=i,t.getMutation=a,t.getData=s}(meru||(meru={}));var meru;!function(t){var e=function(){function e(){this._classList=[]}return e.prototype.injection=function(t,e,n){var r={types:t.split(" "),classType:e,priority:n};this._classList.push(r),this._classList.sort(function(t,e){return e.priority-t.priority})},e.prototype.checkValue=function(e,n){var r=n.split("=");return r.length>1?t.object.getValue(e,r[0])==r[1]:t.object.hasValue(e,r[0])},e.prototype.getClass=function(e){var n,r=this;return n=is.string(e)?t.array.find(this._classList,function(t){return t.types.every(function(t){return t.split("|").indexOf(e)>-1})}):t.array.find(this._classList,function(t){return t.types.every(function(t){if(t.indexOf("|")>-1){var n=t.split("|");return n.some(function(t){return r.checkValue(e,t)})}return r.checkValue(e,t)})}),is.truthy(n)?n.classType:null},e.get=function(n,r){return t.typeSingleton(n,e).getClass(r)},e.instance=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=this.get(t,e);return o?new(o.bind.apply(o,[void 0].concat(n))):null},e.injection=function(n,r,o,i){void 0===i&&(i=1),t.typeSingleton(n,e).injection(r,o,i)},e}();t.factory=e,__reflect(e.prototype,"meru.factory")}(meru||(meru={}));var meru;!function(t){function e(t,e){if(is.truthy(t)){var n=egret.getDefinitionByName(t);if(is.truthy(n))return n}return e}function n(t,n){void 0===n&&(n=null);for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=e(t,n);return is.truthy(i)?new(i.bind.apply(i,[void 0].concat(r))):null}t.getDefinitionType=e,t.getDefinitionInstance=n}(meru||(meru={}));var meru;!function(t){function e(t){return t.hasOwnProperty(o)||(t[o]=r++),t[o]}function n(t){return is.truthy(t)&&t.hasOwnProperty(o)}var r=1,o="__meru_type_id__";t.getTypeId=e,t.hasTypeId=n}(meru||(meru={}));var meru;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.ToggleButton);t.CheckBox=e,__reflect(e.prototype,"meru.CheckBox")}(meru||(meru={}));var meru;!function(t){var e=function(){function e(){}return e.setPrefix=function(t){this._prefix=t,this._enable=egret.localStorage.setItem("enabled","1")},e.isSetPrefix=function(){return null!=this._prefix},e.check=function(){if(null==this._prefix)throw new Error("请设置 localStorage.setPrefix")},e.getItemKey=function(t){return t=this._prefix+"-"+t},e.getItem=function(t,e){return void 0===e&&(e=null),this.check(),this._enable?egret.localStorage.getItem(this.getItemKey(t))||e:this._localStorage[this.getItemKey(t)]||e},e.setItem=function(t,e){this.check(),this._enable?egret.localStorage.setItem(this.getItemKey(t),e):this._localStorage[this.getItemKey(t)]=e},e.removeItem=function(t){this.check(),this._enable?egret.localStorage.removeItem(this.getItemKey(t)):delete this._localStorage[this.getItemKey(t)]},e.getUserKey=function(e){var n=t.getCache("i.id");return e=this._prefix+"-"+n+"-"+e},e.getUserItem=function(t,e){return void 0===e&&(e=null),this.check(),this._enable?egret.localStorage.getItem(this.getUserKey(t))||e:this._localStorage[this.getUserKey(t)]||e},e.setUserItem=function(t,e){this.check(),this._enable?egret.localStorage.setItem(this.getUserKey(t),e):this._localStorage[this.getUserKey(t)]=e},e.removeUserItem=function(t){this.check(),this._enable?egret.localStorage.removeItem(this.getUserKey(t)):delete this._localStorage[this.getUserKey(t)]},e._prefix=null,e._enable=!0,e._localStorage={},e}();t.localStorage=e,__reflect(e.prototype,"meru.localStorage")}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){this.hexcase=0,this.b64pad=""}return t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,n){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),n)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var n=this.rstr2binl(t);n.length>16&&(n=this.binl_md5(n,8*t.length));for(var r=Array(16),o=Array(16),i=0;16>i;i++)r[i]=909522486^n[i],o[i]=1549556828^n[i];var a=this.binl_md5(r.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(o.concat(a),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var n,r=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",o="",i=0;i<t.length;i++)n=t.charCodeAt(i),o+=r.charAt(n>>>4&15)+r.charAt(15&n);return o},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="",o=t.length,i=0;o>i;i+=3)for(var a=t.charCodeAt(i)<<16|(o>i+1?t.charCodeAt(i+1)<<8:0)|(o>i+2?t.charCodeAt(i+2):0),s=0;4>s;s++)r+=8*i+6*s>8*t.length?this.b64pad:n.charAt(a>>>6*(3-s)&63);return r},t.prototype.rstr2any=function(t,e){var n,r,o,i,a,s=e.length,u=Array(Math.ceil(t.length/2));for(n=0;n<u.length;n++)u[n]=t.charCodeAt(2*n)<<8|t.charCodeAt(2*n+1);var c=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),h=Array(c);for(r=0;c>r;r++){for(a=Array(),i=0,n=0;n<u.length;n++)i=(i<<16)+u[n],o=Math.floor(i/s),i-=o*s,(a.length>0||o>0)&&(a[a.length]=o);h[r]=i,u=a}var p="";for(n=h.length-1;n>=0;n--)p+=e.charAt(h[n]);return p},t.prototype.str2rstr_utf8=function(t){for(var e,n,r="",o=-1;++o<t.length;)e=t.charCodeAt(o),n=o+1<t.length?t.charCodeAt(o+1):0,e>=55296&&56319>=e&&n>=56320&&57343>=n&&(e=65536+((1023&e)<<10)+(1023&n),o++),127>=e?r+=String.fromCharCode(e):2047>=e?r+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?r+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(r+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return r},t.prototype.str2rstr_utf16le=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(255&t.charCodeAt(n),t.charCodeAt(n)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t.charCodeAt(n)>>>8&255,255&t.charCodeAt(n));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),n=0;n<e.length;n++)e[n]=0;for(var n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return e},t.prototype.binl2rstr=function(t){for(var e="",n=0;n<32*t.length;n+=8)e+=String.fromCharCode(t[n>>5]>>>n%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var n=1732584193,r=-271733879,o=-1732584194,i=271733878,a=0;a<t.length;a+=16){var s=n,u=r,c=o,h=i;n=this.md5_ff(n,r,o,i,t[a+0],7,-680876936),i=this.md5_ff(i,n,r,o,t[a+1],12,-389564586),o=this.md5_ff(o,i,n,r,t[a+2],17,606105819),r=this.md5_ff(r,o,i,n,t[a+3],22,-1044525330),n=this.md5_ff(n,r,o,i,t[a+4],7,-176418897),i=this.md5_ff(i,n,r,o,t[a+5],12,1200080426),o=this.md5_ff(o,i,n,r,t[a+6],17,-1473231341),r=this.md5_ff(r,o,i,n,t[a+7],22,-45705983),n=this.md5_ff(n,r,o,i,t[a+8],7,1770035416),i=this.md5_ff(i,n,r,o,t[a+9],12,-1958414417),o=this.md5_ff(o,i,n,r,t[a+10],17,-42063),r=this.md5_ff(r,o,i,n,t[a+11],22,-1990404162),n=this.md5_ff(n,r,o,i,t[a+12],7,1804603682),i=this.md5_ff(i,n,r,o,t[a+13],12,-40341101),o=this.md5_ff(o,i,n,r,t[a+14],17,-1502002290),r=this.md5_ff(r,o,i,n,t[a+15],22,1236535329),n=this.md5_gg(n,r,o,i,t[a+1],5,-165796510),i=this.md5_gg(i,n,r,o,t[a+6],9,-1069501632),o=this.md5_gg(o,i,n,r,t[a+11],14,643717713),r=this.md5_gg(r,o,i,n,t[a+0],20,-373897302),n=this.md5_gg(n,r,o,i,t[a+5],5,-701558691),i=this.md5_gg(i,n,r,o,t[a+10],9,38016083),o=this.md5_gg(o,i,n,r,t[a+15],14,-660478335),r=this.md5_gg(r,o,i,n,t[a+4],20,-405537848),n=this.md5_gg(n,r,o,i,t[a+9],5,568446438),i=this.md5_gg(i,n,r,o,t[a+14],9,-1019803690),o=this.md5_gg(o,i,n,r,t[a+3],14,-187363961),r=this.md5_gg(r,o,i,n,t[a+8],20,1163531501),n=this.md5_gg(n,r,o,i,t[a+13],5,-1444681467),i=this.md5_gg(i,n,r,o,t[a+2],9,-51403784),o=this.md5_gg(o,i,n,r,t[a+7],14,1735328473),r=this.md5_gg(r,o,i,n,t[a+12],20,-1926607734),n=this.md5_hh(n,r,o,i,t[a+5],4,-378558),i=this.md5_hh(i,n,r,o,t[a+8],11,-2022574463),o=this.md5_hh(o,i,n,r,t[a+11],16,1839030562),r=this.md5_hh(r,o,i,n,t[a+14],23,-35309556),n=this.md5_hh(n,r,o,i,t[a+1],4,-1530992060),i=this.md5_hh(i,n,r,o,t[a+4],11,1272893353),o=this.md5_hh(o,i,n,r,t[a+7],16,-155497632),r=this.md5_hh(r,o,i,n,t[a+10],23,-1094730640),n=this.md5_hh(n,r,o,i,t[a+13],4,681279174),i=this.md5_hh(i,n,r,o,t[a+0],11,-358537222),o=this.md5_hh(o,i,n,r,t[a+3],16,-722521979),r=this.md5_hh(r,o,i,n,t[a+6],23,76029189),n=this.md5_hh(n,r,o,i,t[a+9],4,-640364487),i=this.md5_hh(i,n,r,o,t[a+12],11,-421815835),o=this.md5_hh(o,i,n,r,t[a+15],16,530742520),r=this.md5_hh(r,o,i,n,t[a+2],23,-995338651),n=this.md5_ii(n,r,o,i,t[a+0],6,-198630844),i=this.md5_ii(i,n,r,o,t[a+7],10,1126891415),o=this.md5_ii(o,i,n,r,t[a+14],15,-1416354905),r=this.md5_ii(r,o,i,n,t[a+5],21,-57434055),n=this.md5_ii(n,r,o,i,t[a+12],6,1700485571),i=this.md5_ii(i,n,r,o,t[a+3],10,-1894986606),o=this.md5_ii(o,i,n,r,t[a+10],15,-1051523),r=this.md5_ii(r,o,i,n,t[a+1],21,-2054922799),n=this.md5_ii(n,r,o,i,t[a+8],6,1873313359),i=this.md5_ii(i,n,r,o,t[a+15],10,-30611744),o=this.md5_ii(o,i,n,r,t[a+6],15,-1560198380),r=this.md5_ii(r,o,i,n,t[a+13],21,1309151649),n=this.md5_ii(n,r,o,i,t[a+4],6,-145523070),i=this.md5_ii(i,n,r,o,t[a+11],10,-1120210379),o=this.md5_ii(o,i,n,r,t[a+2],15,718787259),r=this.md5_ii(r,o,i,n,t[a+9],21,-343485551),n=this.safe_add(n,s),r=this.safe_add(r,u),o=this.safe_add(o,c),i=this.safe_add(i,h)}return[n,r,o,i]},t.prototype.md5_cmn=function(t,e,n,r,o,i){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(r,i)),o),n)},t.prototype.md5_ff=function(t,e,n,r,o,i,a){return this.md5_cmn(e&n|~e&r,t,e,o,i,a)},t.prototype.md5_gg=function(t,e,n,r,o,i,a){return this.md5_cmn(e&r|n&~r,t,e,o,i,a)},t.prototype.md5_hh=function(t,e,n,r,o,i,a){return this.md5_cmn(e^n^r,t,e,o,i,a)},t.prototype.md5_ii=function(t,e,n,r,o,i,a){return this.md5_cmn(n^(e|~r),t,e,o,i,a)},t.prototype.safe_add=function(t,e){var n=(65535&t)+(65535&e),r=(t>>16)+(e>>16)+(n>>16);return r<<16|65535&n},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();t.md5=e,__reflect(e.prototype,"meru.md5")}(meru||(meru={}));var meru;!function(t){function e(){var e=t.extra.platform||"bj";return t.factory.instance("pf",e)}var n;!function(t){t[t.SendToDesktop=1]="SendToDesktop",t[t.TencentLogin=2]="TencentLogin",t[t.InvitorFriend=3]="InvitorFriend",t[t.OpenBBS=4]="OpenBBS",t[t.Share=5]="Share"}(n=t.PlatformFunType||(t.PlatformFunType={})),t.getPlatform=e}(meru||(meru={}));var meru;!function(t){function e(){if(egret.Capabilities.runtimeType==egret.RuntimeType.WEB){var e={};window.onerror=function(n,r,o,i,a){var s=""+a.stack;-1!=s.indexOf("onResourceItemComp")||e[s]||(e[s]=!0,t.request({moddo:"User.uploadLog",params:{logStr:s}}))}}}t.listenerReport=e}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){}return t.getResVersion=function(){var t=egret.getOption("resVer"),e=t.split(".");return e[0]},t.getThemeVersion=function(){var t=egret.getOption("resVer"),e=t.split(".");return e[1]},t.loadRes=function(t,e){void 0===t&&(t="resource"),void 0===e&&(e=!1);var n=t+"/default.res.json";if(e&&(n=t+"/default.res_dev.json"),egret.Capabilities.runtimeType!=egret.RuntimeType.NATIVE){var r=this.getResVersion();is.truthy(r)&&(n=t+"/resource_"+r+".json")}RES.loadConfig(n,t+"/")},t.loadTheme=function(t,e,n,r,o){void 0===r&&(r=null),void 0===o&&(o="resource");var i=o+"/default.thm.json";if(egret.Capabilities.runtimeType!=egret.RuntimeType.NATIVE){var a=this.getThemeVersion();is.truthy(a)&&(i=o+"/theme_"+a+".json")}var s=new eui.Theme(i,t);s.addEventListener(eui.UIEvent.COMPLETE,n,r)},t}();t.res=e,__reflect(e.prototype,"meru.res")}(meru||(meru={}));var meru;!function(t){var e=function(){function t(t,e){void 0===e&&(e=null),this._runDone=!1,this._args=[],this._sel=t,this._context=e}return t.prototype.invoke=function(){this._sel&&this._sel.call(this._context,this.callback.bind(this))},Object.defineProperty(t.prototype,"runDone",{get:function(){return this._runDone},set:function(t){this._runDone=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"args",{get:function(){return this._args},set:function(t){this._args=t},enumerable:!0,configurable:!0}),t.prototype.callback=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.host&&(this.runDone=!0,this._args=t,this.host.runDone())},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){this._host=t},enumerable:!0,configurable:!0}),t}();__reflect(e.prototype,"SeqInfo");var n=function(){function t(){this._seqArr=[],this._seqCount=0}return t.prototype.run=function(t,n){void 0===n&&(n=null);var r=new e(t,n);return r.host=this,this._seqArr.push(r),r.invoke(),this},t.prototype.runDone=function(){this._seqCount++,this._seqCount>=this._seqArr.length&&this._sel&&this._sel.call(this._context,this.getArgs())},t.prototype.getArgs=function(){return this._seqArr.map(function(t){return t.args})},t.prototype.done=function(t,e){return void 0===e&&(e=null),this._sel=t,this._context=e,this},t.run=function(e,n){return void 0===n&&(n=null),(new t).run(e,n)},t.done=function(e,n){return void 0===n&&(n=null),(new t).done(e,n)},t}();t.Seq=n,__reflect(n.prototype,"meru.Seq")}(meru||(meru={}));var meru;!function(t){function e(e){var n=t.getTypeId(e);return r.hasOwnProperty(n)||(r[n]=new e),r[n]}function n(e,n){var o=e+t.getTypeId(n);return r.hasOwnProperty(o)||(r[o]=new n),r[o]}var r={};t.singleton=e,t.typeSingleton=n}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){this._startTime=this._now(),this._stopTime=-1}return t.prototype.stop=function(){this._stopTime=this._now()},t.prototype.elapsed=function(){return-1!==this._stopTime?this._stopTime-this._startTime:this._now()-this._startTime},t.prototype._now=function(){return(new Date).getTime()},t}();t.StopWatch=e,__reflect(e.prototype,"meru.StopWatch")}(meru||(meru={}));var meru;!function(t){function e(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];return egret.setInterval.apply(egret,[t,e,n].concat(r))}function n(t){egret.clearInterval(t)}function r(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];return egret.setTimeout.apply(egret,[t,e,n].concat(r))}function o(t){egret.clearTimeout(t)
}function i(e){if(is.truthy(e)){var n=t.getCache("i.nowTime"),r=e-n;return r>0?r:0}return 0}function a(t){return s.test(t.toString())}t.setInterval=e,t.clearInterval=n,t.setTimeout=r,t.clearTimeout=o,t.getLeftTime=i;var s=/^\d{10}$|^\d{13}$/;t.isTimestamp=a}(meru||(meru={}));var meru;!function(t){var e=function(){function t(){this._lastDate=-1,this._offsetTime=0,this._tickNum=0}return Object.defineProperty(t.prototype,"tickNum",{get:function(){return this._tickNum},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"seconds",{get:function(){return this._seconds},enumerable:!0,configurable:!0}),t.prototype.tick=function(){var t=1;this._date=new Date;var e=this._date.getTime();if(-1!=this._lastDate){var n=(e-this._lastDate)/1e3;t=Math.floor(n),1>t&&(t=1),this._offsetTime+=n-t,this._offsetTime>=1&&(n=Math.floor(this._offsetTime),t+=n,this._offsetTime=this._offsetTime-n)}return this._lastDate=e,this._tickNum+=t,this._seconds=t,t},t}();t.TimeRecorder=e,__reflect(e.prototype,"meru.TimeRecorder")}(meru||(meru={}));var meru;!function(t){var e=function(){function t(t,e,r,o){void 0===e&&(e=n.emptyOffset),void 0===r&&(r=[]),void 0===o&&(o=null),this.sel=t,this.offsetObj=e,this.vehicleArr=r,this.context=o}return t}();t.DisplayVehicleInfo=e,__reflect(e.prototype,"meru.DisplayVehicleInfo");var n=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return __extends(r,n),r.prototype.init=function(e,n){void 0===n&&(n=!0),this._canRotation=n,this.x=e.x,this.y=e.y,this._display=e,this._display.visible=!1,e.parent&&e.parent.addChild(this),e.x=0,e.y=0,this.addChild(e),this._vehicle=new t.Vehicle(this.x,this.y),this._vehicle.maxForce=10,this._vehicle.maxSpeed=10},r.prototype.follow=function(t){var e=this;this.removeEnterEvent();var n=function(){t.isComplete||(e._vehicle.follow(t),e._vehicle.separate(e.getInfo().vehicleArr),e._vehicle.update(),e.render())};this.addEventListener(egret.Event.ENTER_FRAME,n,this),this._enterFun=n},r.prototype.arrive=function(t){var e=this;this.removeEnterEvent();var n=function(){e._vehicle.arrive(t),e._vehicle.update(),e.render(e.getInfo().offsetObj),e._vehicle.location.distance(t)<4&&e.getInfo().sel&&e.getInfo().sel.call(e.getInfo().context)};this.addEventListener(egret.Event.ENTER_FRAME,n,this),this._enterFun=n},r.prototype.getInfo=function(){return null==this._info&&(this._info=new e(null)),this._info},r.prototype.setInfo=function(t,n,o,i){void 0===n&&(n=null),void 0===o&&(o=[]),void 0===i&&(i=r.emptyOffset),this._info=new e(t,i,o,n)},r.createFromDisplay=function(t,e){void 0===e&&(e=!0);var n=new r;return n.init(t,e),n},r.prototype.separate=function(t){},r.prototype.isEqual=function(t){return t instanceof r?this._vehicle==t._vehicle:this._vehicle==t},Object.defineProperty(r.prototype,"radius",{get:function(){return this._vehicle.radius},set:function(t){this._vehicle.radius=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"location",{get:function(){return this._vehicle.location},enumerable:!0,configurable:!0}),r.prototype.render=function(t){void 0===t&&(t=r.emptyOffset),this.x=this._vehicle.location.x+t.x,this.y=this._vehicle.location.y+t.y,this._canRotation&&(this.rotation=180*this._vehicle.velocity.heading()/Math.PI),this._display.visible=!0},r.prototype.removeEnterEvent=function(){this._enterFun&&(this.removeEventListener(egret.Event.ENTER_FRAME,this._enterFun,this),this._enterFun=null)},Object.defineProperty(r.prototype,"vec",{get:function(){return this._vehicle},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"wanderInfo",{get:function(){return this._vehicle.wanderInfo},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cohesionInfo",{get:function(){return this._vehicle.cohesionInfo},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"alignInfo",{get:function(){return this._vehicle.alignInfo},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"separationInfo",{get:function(){return this._vehicle.separationInfo},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"localtion",{get:function(){return this._vehicle.location},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"velocity",{get:function(){return this._vehicle.velocity},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxSpeed",{get:function(){return this._vehicle.maxSpeed},set:function(t){this._vehicle.maxSpeed=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxForce",{get:function(){return this._vehicle.maxForce},set:function(t){this._vehicle.maxForce=t},enumerable:!0,configurable:!0}),r.prototype.dispose=function(){this.removeEnterEvent()},r.emptyOffset={x:0,y:0},r}(egret.DisplayObjectContainer);t.DisplayVehicle=n,__reflect(n.prototype,"meru.DisplayVehicle",["meru.IVehicle"])}(meru||(meru={}));var meru;!function(t){var e=function(){function t(t){void 0===t&&(t=[]),this._pathWidth=20,this._nodes=t,this._currentIdx=0,this._isLooping=!0}return t.prototype.add=function(t){this._nodes.push(t)},t.prototype.next=function(){if(this._currentIdx<this._nodes.length){var t=this._currentIdx;return this._currentIdx++,this._isLooping&&this._currentIdx>=this._nodes.length&&(this._currentIdx=0),this._nodes[t]}},Object.defineProperty(t.prototype,"isComplete",{get:function(){return this._currentIdx>=this._nodes.length&&this._nodes.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pathWidth",{get:function(){return this._pathWidth},set:function(t){this._pathWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLooping",{get:function(){return this._isLooping},set:function(t){this._isLooping=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"current",{get:function(){return this._nodes[this._currentIdx]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"first",{get:function(){return this._nodes[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"last",{get:function(){return this._nodes[this._nodes.length-1]},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._nodes=[]},t}();t.Path=e,__reflect(e.prototype,"meru.Path")}(meru||(meru={}));var meru;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.lengthSq)},enumerable:!0,configurable:!0}),t.prototype.setTo=function(t,e){return this.x=t,this.y=e,this},t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},t.prototype.offset=function(t,e){this.x+=t,this.y+=e},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},Object.defineProperty(t.prototype,"lengthSq",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!0,configurable:!0}),t.prototype.limit=function(t){return this.lengthSq>t*t&&(this.normalize(),this.mul(t)),this},t.prototype.div=function(t){return this.x/=t,this.y/=t,this},t.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.mul=function(t){return this.x*=t,this.y*=t,this},t.prototype.getAngle2=function(t){var e=this.normalize(),n=t.normalize();return Math.acos(e.dot(n))},t.prototype.getAngle=function(t){var e=t.x-this.x,n=t.y-this.y;return Math.atan2(n,e)},t.prototype.heading=function(){return Math.atan2(this.y,this.x)},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.normalize=function(){var t=this.length;return t>1&&(this.x/=t,this.y/=t),this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.distance=function(t){var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},t.prototype.copy=function(){return new t(this.x,this.y)},t.prototype.isNormalized=function(){return 1==this.length},t.prototype.rotate=function(e,n){void 0===n&&(n=t.rotateEmpty);var r=Math.sin(e),o=Math.cos(e);if(0==n.x&&0==n.y){var i=this.x*o-this.y*r;this.y=this.y*o+this.x*r,this.x=i}else{var i=this.x-n.x,a=this.y-n.y;this.x=i*o-a*r+n.x,this.y=a*o+i*r+n.y}return this},t.pointInTriangle=function(t,e,n,r){var o=n.copy().subtract(t),i=e.copy().subtract(t),a=r.copy().subtract(t),s=o.dot(o),u=o.dot(i),c=o.dot(a),h=i.dot(i),p=i.dot(a),l=1/(s*h-u*u),f=(h*c-u*p)*l;if(0>f||f>1)return!1;var d=(s*p-u*c)*l;return 0>d||d>1?!1:1>=f+d},t.get=function(e){var n=null;return n=e instanceof t?e.copy():new t(e.x,e.y)},t.normalize=function(t){return this.get(t).normalize()},t.add=function(t,e){return this.get(t).add(e)},t.mul=function(t,e){return this.get(t).mul(e)},t.sub=function(t,e){return this.get(t).subtract(e)},t.rotateEmpty={x:0,y:0},t}();t.Vec2d=e,__reflect(e.prototype,"meru.Vec2d")}(meru||(meru={}));var meru;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.add,e),e}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return"true"==this._value||"false"==this._value?"true"==this._value:this._value},set:function(t){this._value=t,this.onUpdate()},enumerable:!0,configurable:!0}),e.prototype.onUpdate=function(){if(this.parent&&this.parent.updateAttribute){var t=this.parent;t.updateAttribute(this)}},e.prototype.add=function(){this.onUpdate()},e}(eui.Component);t.Attribute=e,__reflect(e.prototype,"meru.Attribute")}(meru||(meru={}));